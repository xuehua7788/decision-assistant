# ğŸ“ å†³ç­–åŠ©æ‰‹ç³»ç»Ÿ - æŠ€æœ¯æ¶æ„æ·±åº¦è§£æ

> **æ–‡æ¡£åˆ›å»ºæ—¶é—´ï¼š** 2025å¹´11æœˆ4æ—¥  
> **é¡¹ç›®åç§°ï¼š** Decision Assistantï¼ˆæ™ºèƒ½æŠ•èµ„å†³ç­–åŠ©æ‰‹ï¼‰  
> **ä½œè€…ï¼š** AI Assistant  
> **ç›®æ ‡è¯»è€…ï¼š** é¡¹ç›®å¼€å‘è€…ã€æŠ€æœ¯å­¦ä¹ è€…

---

## ç›®å½•

1. [ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ](#ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ)
2. [å‰ç«¯æŠ€æœ¯æ ˆ](#å‰ç«¯æŠ€æœ¯æ ˆ)
3. [åç«¯æŠ€æœ¯æ ˆ](#åç«¯æŠ€æœ¯æ ˆ)
4. [æ•°æ®åº“è®¾è®¡](#æ•°æ®åº“è®¾è®¡)
5. [å¤–éƒ¨APIé›†æˆ](#å¤–éƒ¨apié›†æˆ)
6. [éƒ¨ç½²æ¶æ„](#éƒ¨ç½²æ¶æ„)
7. [å®Œæ•´æ•°æ®æµç¤ºä¾‹](#å®Œæ•´æ•°æ®æµç¤ºä¾‹)
8. [æ ¸å¿ƒæ¦‚å¿µæ€»ç»“](#æ ¸å¿ƒæ¦‚å¿µæ€»ç»“)

---

## ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å‰ç«¯      â”‚ HTTP    â”‚   åç«¯      â”‚  SQL    â”‚  æ•°æ®åº“     â”‚
â”‚  (React)    â”‚â—„â”€â”€â”€â”€â”€â”€â–ºâ”‚  (Flask)    â”‚â—„â”€â”€â”€â”€â”€â”€â–ºâ”‚(PostgreSQL) â”‚
â”‚  Verceléƒ¨ç½² â”‚  JSON   â”‚ Renderéƒ¨ç½²  â”‚         â”‚ Renderæ‰˜ç®¡  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                       â”‚
       â”‚                       â”‚
       â–¼                       â–¼
  æµè§ˆå™¨ç”¨æˆ·           å¤–éƒ¨API(Alpha Vantage, DeepSeek)
```

### æŠ€æœ¯æ ˆä¸€è§ˆ

| å±‚çº§ | æŠ€æœ¯ | ç”¨é€” |
|------|------|------|
| **å‰ç«¯** | React + JavaScript | ç”¨æˆ·ç•Œé¢ |
| **å›¾è¡¨** | Recharts | æ•°æ®å¯è§†åŒ–ï¼ˆKçº¿å›¾ã€æŸç›Šå›¾ï¼‰ |
| **å›½é™…åŒ–** | i18n | ä¸­è‹±æ–‡åˆ‡æ¢ |
| **åç«¯** | Flask (Python) | APIæœåŠ¡ã€ä¸šåŠ¡é€»è¾‘ |
| **æ•°æ®åº“** | PostgreSQL | æ•°æ®æŒä¹…åŒ–å­˜å‚¨ |
| **æ•°æ®åˆ†æ** | Alpha Vantage API | è‚¡ç¥¨å®æ—¶/å†å²æ•°æ® |
| **AIåˆ†æ** | DeepSeek API | æ™ºèƒ½æŠ•èµ„å»ºè®® |
| **éƒ¨ç½²** | Vercel + Render | ç”Ÿäº§ç¯å¢ƒæ‰˜ç®¡ |

---

## 1ï¸âƒ£ å‰ç«¯æŠ€æœ¯æ ˆ

### æŠ€æœ¯ï¼šReact + JavaScript

#### 1.1 Reactç»„ä»¶ï¼ˆComponentï¼‰

**æ¦‚å¿µè§£é‡Šï¼š** ç»„ä»¶æ˜¯ç‹¬ç«‹çš„UIæ¨¡å—ï¼Œåƒä¹é«˜ç§¯æœ¨ä¸€æ ·å¯ä»¥ç»„åˆä½¿ç”¨ã€‚

**ä»£ç ç¤ºä¾‹ï¼š**

```javascript
// frontend/src/StockAnalysis.js
import React, { useState } from 'react';

function StockAnalysis({ apiUrl }) {
  // âœ… useState - ReactçŠ¶æ€é’©å­ï¼Œç”¨äºå­˜å‚¨å’Œæ›´æ–°æ•°æ®
  const [symbol, setSymbol] = useState('');           // è‚¡ç¥¨ä»£ç 
  const [stockData, setStockData] = useState(null);   // è‚¡ç¥¨æ•°æ®
  const [loading, setLoading] = useState(false);      // åŠ è½½çŠ¶æ€
  const [analysis, setAnalysis] = useState(null);     // AIåˆ†æç»“æœ
  
  return (
    <div>
      <input 
        value={symbol} 
        onChange={(e) => setSymbol(e.target.value)} 
        placeholder="è¾“å…¥è‚¡ç¥¨ä»£ç "
      />
      <button onClick={searchStock}>æœç´¢</button>
      
      {loading && <p>åŠ è½½ä¸­...</p>}
      {stockData && <StockChart data={stockData} />}
      {analysis && <AnalysisResult data={analysis} />}
    </div>
  );
}
```

**å…³é”®æ¦‚å¿µï¼š**
- **ç»„ä»¶** = ç‹¬ç«‹çš„UIæ¨¡å—
- **useState** = çŠ¶æ€ç®¡ç†ï¼ˆ"è®°å¿†"åŠŸèƒ½ï¼‰
- `symbol` = å½“å‰å€¼
- `setSymbol` = æ›´æ–°å‡½æ•°

---

#### 1.2 HTTPè¯·æ±‚ - å‰ç«¯è°ƒç”¨åç«¯API

**æ¦‚å¿µè§£é‡Šï¼š** å‰ç«¯é€šè¿‡HTTPè¯·æ±‚ä¸åç«¯é€šä¿¡ï¼Œåƒ"æ‰“ç”µè¯"ä¸€æ ·å‘é€è¯·æ±‚å’Œæ¥æ”¶å“åº”ã€‚

**ä»£ç ç¤ºä¾‹ï¼š**

```javascript
// ã€GETè¯·æ±‚ã€‘- è·å–è‚¡ç¥¨æ•°æ®
const searchStock = async (targetSymbol) => {
  try {
    // å‘é€HTTP GETè¯·æ±‚åˆ°åç«¯
    const response = await fetch(`${apiUrl}/api/stock/${targetSymbol.toUpperCase()}`);
    
    // è§£æJSONå“åº”
    const result = await response.json();
    
    if (result.status === 'success') {
      setStockData(result.data);  // æ›´æ–°çŠ¶æ€
    } else {
      setError(result.message);
    }
  } catch (err) {
    setError('ç½‘ç»œè¿æ¥å¤±è´¥: ' + err.message);
  }
};

// ã€POSTè¯·æ±‚ã€‘- æäº¤AIåˆ†æè¯·æ±‚
const analyzeStock = async () => {
  try {
    const response = await fetch(`${apiUrl}/api/stock/analyze`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        symbol: 'AAPL',
        investment_style: 'buffett',
        news_context: 'è‹¹æœå‘å¸ƒæ–°äº§å“...',
        user_opinion: 'æˆ‘çœ‹å¥½è¿™åªè‚¡ç¥¨'
      })
    });
    
    const result = await response.json();
    
    if (result.status === 'success') {
      setAnalysis(result.analysis);
      setOptionStrategy(result.option_strategy);
    }
  } catch (err) {
    setError('åˆ†æå¤±è´¥: ' + err.message);
  }
};
```

**å…³é”®æ¦‚å¿µï¼š**
- **fetch()** = æµè§ˆå™¨å†…ç½®çš„HTTPè¯·æ±‚å·¥å…·
- **GETè¯·æ±‚** = è·å–æ•°æ®ï¼ˆåƒæŸ¥å­—å…¸ï¼‰
- **POSTè¯·æ±‚** = æäº¤æ•°æ®ï¼ˆåƒæäº¤è¡¨å•ï¼‰
- **JSON** = æ•°æ®æ ¼å¼ï¼ˆJavaScript Object Notationï¼‰
- **async/await** = å¼‚æ­¥æ“ä½œï¼ˆç­‰å¾…ç½‘ç»œå“åº”ï¼‰

---

#### 1.3 å®æˆ˜æ¡ˆä¾‹ï¼šä¿å­˜æŠ•èµ„ç­–ç•¥

```javascript
const acceptStrategy = async () => {
  if (!stockData || !analysis || !optionStrategy) {
    alert('âš ï¸ å½“å‰æ²¡æœ‰æœŸæƒç­–ç•¥æ¨èï¼Œæ— æ³•ä¿å­˜');
    return;
  }

  // ä»localStorageè·å–å½“å‰ç™»å½•ç”¨æˆ·
  const currentUser = localStorage.getItem('username');
  if (!currentUser) {
    alert('âŒ è¯·å…ˆç™»å½•ï¼');
    return;
  }

  try {
    // å‘é€ç­–ç•¥åˆ°åç«¯ä¿å­˜
    const response = await fetch(`${apiUrl}/api/user/save-strategy`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        username: currentUser,
        strategy: {
          strategy_id: `${stockData.quote.symbol}_${Date.now()}_${investmentStyle}`,
          symbol: stockData.quote.symbol,
          company_name: stockData.quote.name,
          investment_style: investmentStyle,
          recommendation: analysis.recommendation,
          target_price: analysis.target_price,
          stop_loss: analysis.stop_loss,
          current_price: stockData.quote.price,
          option_strategy: optionStrategy  // æœŸæƒç­–ç•¥
        }
      })
    });

    const result = await response.json();
    
    if (result.status === 'success') {
      alert(`âœ… ç­–ç•¥å·²ä¿å­˜ï¼\næ‚¨å¯ä»¥åœ¨"ç­–ç•¥è¯„ä¼°"æ¨¡å—æŸ¥çœ‹å†å²è¡¨ç°`);
    } else {
      alert('âŒ ä¿å­˜å¤±è´¥: ' + result.message);
    }
  } catch (err) {
    alert('âŒ ç½‘ç»œé”™è¯¯: ' + err.message);
  }
};
```

---

## 2ï¸âƒ£ åç«¯æŠ€æœ¯æ ˆ

### æŠ€æœ¯ï¼šFlaskï¼ˆPython Webæ¡†æ¶ï¼‰

#### 2.1 Flaskåº”ç”¨ + è“å›¾ï¼ˆBlueprintï¼‰

**æ¦‚å¿µè§£é‡Šï¼š** Flaskæ˜¯Pythonçš„Webæ¡†æ¶ï¼ŒBlueprintæ˜¯æ¨¡å—åŒ–ç®¡ç†è·¯ç”±çš„å·¥å…·ã€‚

**ä»£ç ç¤ºä¾‹ï¼š**

```python
# backend/app.py
from flask import Flask, request, jsonify
from flask_cors import CORS

# åˆ›å»ºFlaskåº”ç”¨
app = Flask(__name__)

# CORSé…ç½® - å…è®¸å‰ç«¯è·¨åŸŸè®¿é—®
CORS(app, 
     resources={r"/*": {"origins": "*"}},  # å…è®¸æ‰€æœ‰æ¥æº
     methods=["GET", "POST", "PUT", "DELETE", "OPTIONS"])

# æ³¨å†Œè“å›¾ï¼ˆæ¨¡å—åŒ–è·¯ç”±ï¼‰
from stock_analysis_api import stock_bp
app.register_blueprint(stock_bp)  # è‚¡ç¥¨åˆ†æè·¯ç”±

from algorithm_api import algorithm_bp
app.register_blueprint(algorithm_bp)  # ç®—æ³•åˆ†æè·¯ç”±

if __name__ == '__main__':
    port = int(os.environ.get('PORT', 8000))
    app.run(host='0.0.0.0', port=port, debug=False)
```

**å…³é”®æ¦‚å¿µï¼š**
- **Flask** = Pythonçš„è½»é‡çº§Webæ¡†æ¶
- **CORS** = Cross-Origin Resource Sharingï¼ˆè·¨åŸŸèµ„æºå…±äº«ï¼‰
  - é—®é¢˜ï¼šæµè§ˆå™¨é»˜è®¤ç¦æ­¢è·¨åŸŸè¯·æ±‚ï¼ˆå‰ç«¯åœ¨`vercel.app`ï¼Œåç«¯åœ¨`render.com`ï¼‰
  - è§£å†³ï¼šé…ç½®CORSå…è®¸è·¨åŸŸ
- **Blueprint** = è·¯ç”±æ¨¡å—ï¼ˆåƒä¹¦çš„ç« èŠ‚ï¼Œæ–¹ä¾¿ç®¡ç†ï¼‰

---

#### 2.2 APIè·¯ç”±ï¼ˆRouteï¼‰

**æ¦‚å¿µè§£é‡Šï¼š** è·¯ç”±æ˜¯URLåœ°å€åˆ°å‡½æ•°çš„æ˜ å°„ï¼Œåƒ"é¤å…èœå•"ä¸€æ ·ï¼Œæ¯ä¸ªèœå¯¹åº”ä¸€ä¸ªåŠŸèƒ½ã€‚

**ä»£ç ç¤ºä¾‹ï¼š**

```python
# backend/stock_analysis_api.py
from flask import Blueprint, request, jsonify

# åˆ›å»ºBlueprintï¼ˆè·¯ç”±æ¨¡å—ï¼‰
stock_bp = Blueprint('stock', __name__, url_prefix='/api/stock')

# ============================================================
# è·¯ç”±å®šä¹‰ - é¡ºåºå¾ˆé‡è¦ï¼
# ============================================================

# ã€è·¯ç”±1ã€‘æœç´¢è‚¡ç¥¨
@stock_bp.route('/search', methods=['GET', 'OPTIONS'])
def search_stocks():
    """
    æœç´¢è‚¡ç¥¨ï¼ˆé€šè¿‡å…¬å¸åæˆ–ä»£ç ï¼‰
    URL: GET /api/stock/search?keywords=apple
    """
    if request.method == 'OPTIONS':
        return jsonify({"status": "ok"}), 200
    
    keywords = request.args.get('keywords', '').strip()  # è·å–æŸ¥è¯¢å‚æ•°
    
    if not keywords:
        return jsonify({
            "status": "error",
            "message": "è¯·æä¾›æœç´¢å…³é”®è¯"
        }), 400
    
    # è°ƒç”¨Alpha Vantageæœç´¢API
    results = search_stocks_by_keyword(keywords)
    
    return jsonify({
        "status": "success",
        "results": results
    }), 200


# ã€è·¯ç”±2ã€‘è·å–çƒ­é—¨è‚¡ç¥¨
@stock_bp.route('/trending', methods=['GET'])
def get_trending_stocks():
    """
    URL: GET /api/stock/trending
    """
    trending = ["AAPL", "GOOGL", "MSFT", "TSLA", "NVDA"]
    
    return jsonify({
        "status": "success",
        "stocks": trending
    }), 200


# ã€è·¯ç”±3ã€‘è·å–è‚¡ç¥¨æ•°æ®ï¼ˆé€šç”¨è·¯ç”±ï¼Œå¿…é¡»æ”¾æœ€åï¼‰
@stock_bp.route('/<symbol>', methods=['GET', 'OPTIONS'])
def get_stock_data(symbol):
    """
    è·å–è‚¡ç¥¨æ•°æ®
    URL: GET /api/stock/AAPL
    """
    if request.method == 'OPTIONS':
        return jsonify({"status": "ok"}), 200
    
    # è°ƒç”¨Alpha Vantage APIè·å–æ•°æ®
    quote = get_quote(symbol)
    history = get_daily_history(symbol, days=30)
    
    if not quote:
        return jsonify({
            "status": "error",
            "message": f"æœªæ‰¾åˆ°è¯¥è‚¡ç¥¨: {symbol}"
        }), 404
    
    return jsonify({
        "status": "success",
        "data": {
            "quote": quote,
            "history": history
        }
    }), 200


# ã€è·¯ç”±4ã€‘AIåˆ†æ
@stock_bp.route('/analyze', methods=['POST'])
def analyze_stock():
    """
    åˆ†æè‚¡ç¥¨å¹¶ç»™å‡ºAIå»ºè®®
    URL: POST /api/stock/analyze
    Body: {
        "symbol": "AAPL",
        "investment_style": "buffett",
        "user_opinion": "æˆ‘è®¤ä¸ºè‹¹æœæ–°äº§å“ä¼šå¤§å–...",
        "news_context": "è‹¹æœå‘å¸ƒæ–°æ¬¾iPhone..."
    }
    """
    data = request.json  # è·å–POSTçš„JSONæ•°æ®
    symbol = data.get('symbol', '').upper()
    investment_style = data.get('investment_style', 'buffett')
    user_opinion = data.get('user_opinion', '').strip()
    news_context = data.get('news_context', '').strip()
    
    if not symbol:
        return jsonify({
            "status": "error",
            "message": "è¯·æä¾›è‚¡ç¥¨ä»£ç "
        }), 400
    
    # 1. è·å–è‚¡ç¥¨æ•°æ®
    client = get_alpha_vantage_client()
    quote = client.get_quote(symbol)
    history = client.get_daily_history(symbol, days=30)
    
    # 2. AIåˆ†æ
    analyzer = get_stock_analyzer()
    analysis = analyzer.analyze_stock(
        symbol=symbol,
        current_data=quote,
        history_data=history,
        user_opinion=user_opinion,
        news_context=news_context,
        investment_style=investment_style
    )
    
    # 3. ç”ŸæˆæœŸæƒç­–ç•¥
    option_strategy = generate_option_strategy(analysis, quote['price'])
    
    return jsonify({
        "status": "success",
        "analysis": analysis,
        "option_strategy": option_strategy
    }), 200
```

**å…³é”®æ¦‚å¿µï¼š**

| æ¦‚å¿µ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| **è·¯ç”±** | URLåˆ°å‡½æ•°çš„æ˜ å°„ | `/api/stock/AAPL` â†’ `get_stock_data('AAPL')` |
| **HTTPæ–¹æ³•** | è¯·æ±‚ç±»å‹ | `GET`(æŸ¥è¯¢), `POST`(æäº¤), `DELETE`(åˆ é™¤) |
| **request.args** | è·å–URLå‚æ•° | `?keywords=apple` â†’ `request.args.get('keywords')` |
| **request.json** | è·å–POSTçš„JSONæ•°æ® | `{"symbol": "AAPL"}` â†’ `request.json` |
| **jsonify()** | è¿”å›JSONå“åº” | `jsonify({"status": "success"})` |
| **çŠ¶æ€ç ** | HTTPå“åº”çŠ¶æ€ | `200`(æˆåŠŸ), `404`(æœªæ‰¾åˆ°), `500`(æœåŠ¡å™¨é”™è¯¯) |

**âš ï¸ è·¯ç”±é¡ºåºçš„é‡è¦æ€§ï¼š**

```python
# âœ… æ­£ç¡®é¡ºåº
@stock_bp.route('/search', ...)    # å…·ä½“è·¯ç”±
@stock_bp.route('/trending', ...)  # å…·ä½“è·¯ç”±
@stock_bp.route('/<symbol>', ...)  # é€šç”¨è·¯ç”±ï¼ˆæ”¾æœ€åï¼‰

# âŒ é”™è¯¯é¡ºåº
@stock_bp.route('/<symbol>', ...)  # é€šç”¨è·¯ç”±åœ¨å‰
@stock_bp.route('/search', ...)    # 'search'ä¼šè¢«å½“ä½œsymbolå¤„ç†
```

---

#### 2.3 JSONå“åº”æ ¼å¼

**æ¦‚å¿µè§£é‡Šï¼š** JSONæ˜¯å‰åç«¯é€šä¿¡çš„æ ‡å‡†æ ¼å¼ï¼Œç»“æ„åŒ–ä¸”æ˜“äºè§£æã€‚

**ç»Ÿä¸€å“åº”æ ¼å¼ï¼š**

```python
# æˆåŠŸå“åº”
{
  "status": "success",
  "data": {...},           # æ•°æ®å†…å®¹
  "message": "æ“ä½œæˆåŠŸ"     # å¯é€‰æ¶ˆæ¯
}

# é”™è¯¯å“åº”
{
  "status": "error",
  "message": "é”™è¯¯ä¿¡æ¯"
}
```

**å®é™…ç¤ºä¾‹ï¼š**

```python
# ç¤ºä¾‹1ï¼šè·å–è‚¡ç¥¨æ•°æ®æˆåŠŸ
{
  "status": "success",
  "data": {
    "quote": {
      "symbol": "AAPL",
      "name": "Apple Inc.",
      "price": 178.50,
      "change": 2.30,
      "change_percent": 1.31,
      "volume": 50000000
    },
    "history": [
      {"date": "2025-11-01", "close": 176.20, "volume": 48000000},
      {"date": "2025-10-31", "close": 175.00, "volume": 45000000}
    ],
    "premium_data": {
      "company_overview": {...},
      "technical_indicators": {...},
      "economic_data": {...}
    }
  }
}

# ç¤ºä¾‹2ï¼šAIåˆ†ææˆåŠŸ
{
  "status": "success",
  "analysis": {
    "score": 75,
    "recommendation": "ä¹°å…¥",
    "position_size": "20%",
    "target_price": 190.0,
    "stop_loss": 175.0,
    "key_points": [
      "æŠ€æœ¯é¢å¼ºåŠ¿ï¼Œä»·æ ¼çªç ´å…³é”®é˜»åŠ›ä½",
      "RSIå¤„äºå¥åº·åŒºé—´ï¼Œæœªè¶…ä¹°",
      "æˆäº¤é‡æ”¾å¤§ï¼Œå¸‚åœºå…³æ³¨åº¦æå‡"
    ],
    "analysis_summary": "ç»¼åˆåˆ†æ...",
    "strategy": "åŸºäºå·´è²ç‰¹ä»·å€¼æŠ•èµ„ç†å¿µ...",
    "market_direction": "bullish",
    "direction_strength": "strong"
  },
  "option_strategy": {
    "name": "ä¹°å…¥çœ‹æ¶¨æœŸæƒ",
    "type": "call",
    "description": "é€‚åˆçœ‹æ¶¨è¡Œæƒ…...",
    "strike": 180.0,
    "expiry": "2025-01-17",
    "payoff_diagram": [...]
  }
}

# ç¤ºä¾‹3ï¼šé”™è¯¯å“åº”
{
  "status": "error",
  "message": "æœªæ‰¾åˆ°è¯¥è‚¡ç¥¨: INVALID"
}
```

---

## 3ï¸âƒ£ æ•°æ®åº“è®¾è®¡

### æŠ€æœ¯ï¼šPostgreSQL

#### 3.1 SQLåŸºç¡€æ“ä½œï¼ˆCRUDï¼‰

**æ¦‚å¿µè§£é‡Šï¼š** CRUD = Createï¼ˆåˆ›å»ºï¼‰ã€Readï¼ˆè¯»å–ï¼‰ã€Updateï¼ˆæ›´æ–°ï¼‰ã€Deleteï¼ˆåˆ é™¤ï¼‰

**ä»£ç ç¤ºä¾‹ï¼š**

```python
import psycopg2
from psycopg2.extras import RealDictCursor

# è¿æ¥æ•°æ®åº“
DATABASE_URL = "postgresql://user:password@host:5432/database"
conn = psycopg2.connect(DATABASE_URL)
cur = conn.cursor(cursor_factory=RealDictCursor)

# ========================================
# 1. CREATE - æ’å…¥æ•°æ®
# ========================================
cur.execute("""
    INSERT INTO users (username, email, password)
    VALUES (%s, %s, %s)
    RETURNING id
""", ('alice', 'alice@example.com', 'hashed_password'))

new_user_id = cur.fetchone()['id']
conn.commit()

# ========================================
# 2. READ - æŸ¥è¯¢æ•°æ®
# ========================================
# æŸ¥è¯¢å•ä¸ªç”¨æˆ·
cur.execute("""
    SELECT id, username, email, created_at
    FROM users 
    WHERE username = %s
""", ('alice',))

user = cur.fetchone()
# user = {"id": 1, "username": "alice", "email": "alice@example.com", ...}

# æŸ¥è¯¢å¤šä¸ªç”¨æˆ·
cur.execute("SELECT * FROM users WHERE created_at > %s", ('2025-01-01',))
users = cur.fetchall()
# users = [{"id": 1, ...}, {"id": 2, ...}, ...]

# ========================================
# 3. UPDATE - æ›´æ–°æ•°æ®
# ========================================
cur.execute("""
    UPDATE users 
    SET email = %s, updated_at = NOW()
    WHERE username = %s
""", ('newemail@example.com', 'alice'))

conn.commit()

# ========================================
# 4. DELETE - åˆ é™¤æ•°æ®
# ========================================
cur.execute("DELETE FROM users WHERE username = %s", ('alice',))
conn.commit()

# å…³é—­è¿æ¥
cur.close()
conn.close()
```

**å…³é”®æ¦‚å¿µï¼š**
- **PostgreSQL** = å¼€æºå…³ç³»å‹æ•°æ®åº“
- **psycopg2** = Pythonçš„PostgreSQLé©±åŠ¨
- **SQL** = Structured Query Languageï¼ˆç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€ï¼‰
- **%s** = å‚æ•°å ä½ç¬¦ï¼ˆé˜²æ­¢SQLæ³¨å…¥æ”»å‡»ï¼‰
- **RealDictCursor** = è¿”å›å­—å…¸æ ¼å¼çš„ç»“æœï¼ˆè€Œä¸æ˜¯å…ƒç»„ï¼‰

---

#### 3.2 JSONBå­—æ®µ - çµæ´»å­˜å‚¨å¤æ‚æ•°æ®

**æ¦‚å¿µè§£é‡Šï¼š** JSONBæ˜¯PostgreSQLçš„JSONäºŒè¿›åˆ¶å­˜å‚¨ç±»å‹ï¼Œé€‚åˆå­˜å‚¨ä¸å®šé•¿ã€ç»“æ„å¯å˜çš„æ•°æ®ã€‚

**æ•°æ®åº“è¡¨ç»“æ„ï¼š**

```sql
-- usersè¡¨ç»“æ„
CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    username VARCHAR(50) UNIQUE NOT NULL,
    email VARCHAR(100) NOT NULL,
    password VARCHAR(255) NOT NULL,
    accepted_strategies JSONB,  -- ğŸ”¥ JSONBå­—æ®µï¼šå­˜å‚¨ç­–ç•¥åˆ—è¡¨
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

-- åˆ›å»ºç´¢å¼•ï¼ˆæå‡JSONBæŸ¥è¯¢æ€§èƒ½ï¼‰
CREATE INDEX idx_users_strategies ON users USING GIN (accepted_strategies);
```

**JSONBæ•°æ®ç¤ºä¾‹ï¼š**

```json
// accepted_strategieså­—æ®µçš„å†…å®¹
[
  {
    "strategy_id": "AAPL_20251104_060307_buffett",
    "symbol": "AAPL",
    "company_name": "Apple Inc.",
    "investment_style": "buffett",
    "recommendation": "ä¹°å…¥",
    "current_price": 178.50,
    "target_price": 190.0,
    "stop_loss": 175.0,
    "score": 75,
    "position_size": "20%",
    "strategy_text": "åŸºäºå·´è²ç‰¹ä»·å€¼æŠ•èµ„ç†å¿µ...",
    "analysis_summary": "ç»¼åˆåˆ†æ...",
    "option_strategy": {
      "name": "ä¹°å…¥çœ‹æ¶¨æœŸæƒ",
      "strike": 180,
      "expiry": "2025-01-17",
      "type": "call",
      "description": "é€‚åˆçœ‹æ¶¨è¡Œæƒ…...",
      "payoff_diagram": [
        {"price": 170, "profit": -5},
        {"price": 180, "profit": -5},
        {"price": 190, "profit": 5}
      ]
    },
    "created_at": "2025-11-04T12:03:07",
    "status": "active"
  },
  {
    "strategy_id": "NVDA_20251103_150230_lynch",
    "symbol": "NVDA",
    "company_name": "NVIDIA Corporation",
    "investment_style": "lynch",
    "recommendation": "è§‚æœ›",
    "current_price": 450.30,
    "target_price": 480.0,
    "stop_loss": 430.0,
    "score": 68,
    "created_at": "2025-11-03T15:02:30",
    "status": "active"
  }
  // ... æ›´å¤šç­–ç•¥
]
```

**Pythonæ“ä½œJSONBï¼š**

```python
import json

# ========================================
# 1. ä¿å­˜ç­–ç•¥åˆ°JSONBå­—æ®µ
# ========================================
@app.route('/api/user/save-strategy', methods=['POST'])
def save_user_strategy():
    data = request.json
    username = data.get('username')
    new_strategy = data.get('strategy')
    
    # è·å–ç”¨æˆ·å½“å‰çš„ç­–ç•¥åˆ—è¡¨
    cur.execute("""
        SELECT accepted_strategies 
        FROM users 
        WHERE username = %s
    """, (username,))
    
    result = cur.fetchone()
    
    # å¦‚æœä¸ºç©ºï¼Œåˆå§‹åŒ–ä¸ºç©ºåˆ—è¡¨
    current_strategies = result['accepted_strategies'] if result['accepted_strategies'] else []
    
    # æ·»åŠ æ–°ç­–ç•¥
    from datetime import datetime
    new_strategy['created_at'] = datetime.now().isoformat()
    new_strategy['status'] = 'active'
    current_strategies.append(new_strategy)
    
    # æ›´æ–°æ•°æ®åº“ï¼ˆä½¿ç”¨::jsonbå¼ºåˆ¶ç±»å‹è½¬æ¢ï¼‰
    cur.execute("""
        UPDATE users 
        SET accepted_strategies = %s::jsonb,
            updated_at = NOW()
        WHERE username = %s
    """, (json.dumps(current_strategies, ensure_ascii=False), username))
    
    conn.commit()
    
    return jsonify({
        "status": "success",
        "message": "ç­–ç•¥ä¿å­˜æˆåŠŸ",
        "strategy_count": len(current_strategies)
    }), 200


# ========================================
# 2. æŸ¥è¯¢ç”¨æˆ·çš„æ‰€æœ‰ç­–ç•¥
# ========================================
@app.route('/api/user/<username>/strategies', methods=['GET'])
def get_user_strategies(username):
    cur.execute("""
        SELECT 
            username,
            email,
            accepted_strategies,
            created_at
        FROM users 
        WHERE username = %s
    """, (username,))
    
    result = cur.fetchone()
    
    if not result:
        return jsonify({
            "status": "error",
            "message": "ç”¨æˆ·ä¸å­˜åœ¨"
        }), 404
    
    strategies = result['accepted_strategies'] if result['accepted_strategies'] else []
    
    return jsonify({
        "status": "success",
        "username": username,
        "strategies": strategies,
        "total": len(strategies)
    }), 200


# ========================================
# 3. åˆ é™¤ç‰¹å®šç­–ç•¥
# ========================================
@app.route('/api/user/<username>/strategies/<strategy_id>', methods=['DELETE'])
def delete_user_strategy(username, strategy_id):
    # è·å–å½“å‰ç­–ç•¥åˆ—è¡¨
    cur.execute("""
        SELECT accepted_strategies 
        FROM users 
        WHERE username = %s
    """, (username,))
    
    result = cur.fetchone()
    strategies = result['accepted_strategies'] if result['accepted_strategies'] else []
    
    # è¿‡æ»¤æ‰è¦åˆ é™¤çš„ç­–ç•¥
    new_strategies = [s for s in strategies if s.get('strategy_id') != strategy_id]
    
    if len(new_strategies) == len(strategies):
        return jsonify({
            "status": "error",
            "message": "ç­–ç•¥ä¸å­˜åœ¨"
        }), 404
    
    # æ›´æ–°æ•°æ®åº“
    cur.execute("""
        UPDATE users 
        SET accepted_strategies = %s::jsonb
        WHERE username = %s
    """, (json.dumps(new_strategies, ensure_ascii=False), username))
    
    conn.commit()
    
    return jsonify({
        "status": "success",
        "message": "ç­–ç•¥åˆ é™¤æˆåŠŸ",
        "remaining": len(new_strategies)
    }), 200
```

**JSONBçš„ä¼˜åŠ¿ï¼š**

| ç‰¹æ€§ | è¯´æ˜ | åº”ç”¨åœºæ™¯ |
|------|------|---------|
| **çµæ´»æ€§** | ä¸éœ€è¦é¢„å®šä¹‰å­—æ®µ | ç”¨æˆ·ç­–ç•¥æ•°é‡ä¸å›ºå®š |
| **åµŒå¥—æ”¯æŒ** | æ”¯æŒå¤šå±‚åµŒå¥—å¯¹è±¡ | æœŸæƒç­–ç•¥åŒ…å«å¤šä¸ªå­å­—æ®µ |
| **æŸ¥è¯¢èƒ½åŠ›** | æ”¯æŒJSONå†…éƒ¨å­—æ®µæŸ¥è¯¢ | `WHERE accepted_strategies @> '{"symbol": "AAPL"}'` |
| **æ€§èƒ½** | äºŒè¿›åˆ¶å­˜å‚¨ï¼Œæ¯”TEXTå¿« | å¤§é‡ç­–ç•¥æ•°æ®çš„å¿«é€Ÿæ£€ç´¢ |
| **ç´¢å¼•** | æ”¯æŒGINç´¢å¼• | åŠ é€ŸJSONBå­—æ®µæŸ¥è¯¢ |

---

## 4ï¸âƒ£ å¤–éƒ¨APIé›†æˆ

### 4.1 Alpha Vantageï¼ˆè‚¡ç¥¨æ•°æ®APIï¼‰

**æ¦‚å¿µè§£é‡Šï¼š** Alpha Vantageæä¾›è‚¡ç¥¨å®æ—¶/å†å²æ•°æ®ã€æŠ€æœ¯æŒ‡æ ‡ã€å®è§‚ç»æµæ•°æ®ã€‚

**APIè°ƒç”¨ç¤ºä¾‹ï¼š**

```python
# backend/stock_analysis/alpha_vantage_client.py
import requests
import os

class AlphaVantageClient:
    """Alpha Vantage APIå®¢æˆ·ç«¯"""
    
    def __init__(self):
        self.api_key = os.getenv('ALPHA_VANTAGE_API_KEY')
        self.base_url = "https://www.alphavantage.co/query"
        self.cache = {}  # å†…å­˜ç¼“å­˜ï¼ˆé¿å…APIé™åˆ¶ï¼‰
        self.cache_ttl = 900  # 15åˆ†é’Ÿç¼“å­˜
    
    # ========================================
    # 1. è·å–å®æ—¶è‚¡ä»·
    # ========================================
    def get_quote(self, symbol: str):
        """
        è·å–è‚¡ç¥¨å®æ—¶æŠ¥ä»·
        
        Returns:
            {
                "symbol": "AAPL",
                "name": "Apple Inc.",
                "price": 178.50,
                "change": 2.30,
                "change_percent": 1.31,
                "volume": 50000000,
                "high": 182.00,
                "low": 179.00
            }
        """
        params = {
            'function': 'GLOBAL_QUOTE',
            'symbol': symbol,
            'apikey': self.api_key
        }
        
        response = requests.get(self.base_url, params=params, timeout=10)
        data = response.json()
        
        # è§£æAlpha Vantageå“åº”æ ¼å¼
        if "Global Quote" in data and data["Global Quote"]:
            quote = data["Global Quote"]
            
            return {
                "symbol": quote.get("01. symbol"),
                "price": float(quote.get("05. price", 0)),
                "change": float(quote.get("09. change", 0)),
                "change_percent": float(quote.get("10. change percent", "0%").rstrip('%')),
                "volume": int(quote.get("06. volume", 0)),
                "high": float(quote.get("03. high", 0)),
                "low": float(quote.get("04. low", 0))
            }
        
        return None
    
    # ========================================
    # 2. è·å–å†å²æ•°æ®
    # ========================================
    def get_daily_history(self, symbol: str, days: int = 30):
        """
        è·å–å†å²æ—¥Kçº¿æ•°æ®
        
        Returns:
            [
                {"date": "2025-11-01", "open": 177.0, "high": 180.0, 
                 "low": 176.5, "close": 178.5, "volume": 48000000},
                ...
            ]
        """
        params = {
            'function': 'TIME_SERIES_DAILY',
            'symbol': symbol,
            'outputsize': 'compact',  # æœ€è¿‘100å¤©
            'apikey': self.api_key
        }
        
        response = requests.get(self.base_url, params=params, timeout=10)
        data = response.json()
        
        if "Time Series (Daily)" not in data:
            return []
        
        time_series = data["Time Series (Daily)"]
        history = []
        
        for date, values in sorted(time_series.items(), reverse=True)[:days]:
            history.append({
                "date": date,
                "open": float(values["1. open"]),
                "high": float(values["2. high"]),
                "low": float(values["3. low"]),
                "close": float(values["4. close"]),
                "volume": int(values["5. volume"])
            })
        
        return history
    
    # ========================================
    # 3. è·å–æŠ€æœ¯æŒ‡æ ‡ï¼ˆPremiumåŠŸèƒ½ï¼‰
    # ========================================
    def get_technical_indicator(self, symbol: str, indicator: str, 
                                interval: str = 'daily', **kwargs):
        """
        è·å–æŠ€æœ¯æŒ‡æ ‡
        
        Args:
            symbol: è‚¡ç¥¨ä»£ç 
            indicator: æŒ‡æ ‡ç±»å‹ï¼ˆMACD, BBANDS, RSI, ATRç­‰ï¼‰
            interval: æ—¶é—´é—´éš”ï¼ˆdaily, weekly, monthlyï¼‰
            **kwargs: å…¶ä»–å‚æ•°ï¼ˆå¦‚time_period, series_typeï¼‰
        
        Returns:
            æŠ€æœ¯æŒ‡æ ‡æ•°æ®
        """
        params = {
            'function': indicator,
            'symbol': symbol,
            'interval': interval,
            'apikey': self.api_key
        }
        
        # æ·»åŠ é¢å¤–å‚æ•°
        if indicator == 'MACD':
            params['series_type'] = kwargs.get('series_type', 'close')
        elif indicator == 'BBANDS':
            params['series_type'] = kwargs.get('series_type', 'close')
            params['time_period'] = kwargs.get('time_period', 20)
        elif indicator == 'ATR':
            params['time_period'] = kwargs.get('time_period', 14)
        
        response = requests.get(self.base_url, params=params, timeout=10)
        data = response.json()
        
        # è¿”å›åŸå§‹æ•°æ®ï¼ˆå…·ä½“è§£æåœ¨è°ƒç”¨æ–¹ï¼‰
        return data
    
    # ========================================
    # 4. è·å–å®è§‚ç»æµæ•°æ®ï¼ˆPremiumåŠŸèƒ½ï¼‰
    # ========================================
    def get_economic_indicator(self, indicator: str):
        """
        è·å–å®è§‚ç»æµæŒ‡æ ‡
        
        Args:
            indicator: CPI, UNEMPLOYMENT, FEDERAL_FUNDS_RATEç­‰
        
        Returns:
            ç»æµæŒ‡æ ‡æ•°æ®
        """
        params = {
            'function': indicator,
            'apikey': self.api_key
        }
        
        response = requests.get(self.base_url, params=params, timeout=10)
        return response.json()
    
    # ========================================
    # 5. æœç´¢è‚¡ç¥¨
    # ========================================
    def search_stocks(self, keywords: str):
        """
        æœç´¢è‚¡ç¥¨ï¼ˆé€šè¿‡å…¬å¸åæˆ–ä»£ç ï¼‰
        
        Args:
            keywords: æœç´¢å…³é”®è¯ï¼ˆå¦‚"apple"æˆ–"AAPL"ï¼‰
        
        Returns:
            [
                {
                    "symbol": "AAPL",
                    "name": "Apple Inc.",
                    "type": "Equity",
                    "region": "United States"
                },
                ...
            ]
        """
        params = {
            'function': 'SYMBOL_SEARCH',
            'keywords': keywords,
            'apikey': self.api_key
        }
        
        response = requests.get(self.base_url, params=params, timeout=10)
        data = response.json()
        
        if "bestMatches" not in data:
            return []
        
        results = []
        for match in data["bestMatches"]:
            results.append({
                "symbol": match.get("1. symbol"),
                "name": match.get("2. name"),
                "type": match.get("3. type"),
                "region": match.get("4. region")
            })
        
        return results
```

**APIé™åˆ¶ä¸ç¼“å­˜ç­–ç•¥ï¼š**

| APIç±»å‹ | å…è´¹é™åˆ¶ | Premiumé™åˆ¶ | ç¼“å­˜ç­–ç•¥ |
|---------|---------|------------|---------|
| **å®æ—¶æŠ¥ä»·** | 5æ¬¡/åˆ†é’Ÿ | 75æ¬¡/åˆ†é’Ÿ | 15åˆ†é’Ÿç¼“å­˜ |
| **å†å²æ•°æ®** | 5æ¬¡/åˆ†é’Ÿ | 75æ¬¡/åˆ†é’Ÿ | 1å°æ—¶ç¼“å­˜ |
| **æŠ€æœ¯æŒ‡æ ‡** | ä»…é™éƒ¨åˆ† | å…¨éƒ¨å¯ç”¨ | 1å°æ—¶ç¼“å­˜ |
| **ç»æµæ•°æ®** | ä¸å¯ç”¨ | å¯ç”¨ | 24å°æ—¶ç¼“å­˜ |

---

### 4.2 DeepSeek APIï¼ˆAIåˆ†æï¼‰

**æ¦‚å¿µè§£é‡Šï¼š** DeepSeekæ˜¯AIå¤§è¯­è¨€æ¨¡å‹ï¼Œç”¨äºç”ŸæˆæŠ•èµ„åˆ†æå’Œå»ºè®®ã€‚

**APIè°ƒç”¨ç¤ºä¾‹ï¼š**

```python
# backend/stock_analysis/stock_analyzer.py
import requests
import json
import os

class StockAnalyzer:
    """è‚¡ç¥¨AIåˆ†æå™¨"""
    
    def __init__(self):
        self.api_key = os.getenv('DEEPSEEK_API_KEY')
        self.api_url = "https://api.deepseek.com/v1/chat/completions"
    
    def analyze_stock(self, symbol: str, current_data: dict, 
                     history_data: list, rsi: float,
                     investment_style: str = "buffett",
                     user_opinion: str = None,
                     news_context: str = None,
                     language: str = "zh"):
        """
        AIåˆ†æè‚¡ç¥¨
        
        Args:
            symbol: è‚¡ç¥¨ä»£ç 
            current_data: å½“å‰æ•°æ®ï¼ˆä»·æ ¼ã€æ¶¨è·Œå¹…ç­‰ï¼‰
            history_data: å†å²æ•°æ®ï¼ˆ30å¤©ï¼‰
            rsi: RSIæŒ‡æ ‡
            investment_style: æŠ•èµ„é£æ ¼ï¼ˆbuffett/lynch/sorosï¼‰
            user_opinion: ç”¨æˆ·è§‚ç‚¹
            news_context: æ–°é—»æ¶ˆæ¯
            language: è¯­è¨€ï¼ˆzh/enï¼‰
        
        Returns:
            {
                "score": 75,
                "recommendation": "ä¹°å…¥",
                "position_size": "20%",
                "target_price": 190.0,
                "stop_loss": 175.0,
                "key_points": [...],
                "analysis_summary": "...",
                "strategy": "...",
                "market_direction": "bullish",
                "direction_strength": "strong"
            }
        """
        # 1. æ„å»ºç³»ç»Ÿæç¤ºè¯
        system_prompt = self._build_system_prompt(investment_style, language)
        
        # 2. æ„å»ºç”¨æˆ·æç¤ºè¯
        user_prompt = self._build_user_prompt(
            symbol, current_data, history_data, rsi,
            user_opinion, news_context, language
        )
        
        # 3. è°ƒç”¨DeepSeek API
        payload = {
            "model": "deepseek-chat",
            "messages": [
                {"role": "system", "content": system_prompt},
                {"role": "user", "content": user_prompt}
            ],
            "temperature": 0.7,
            "max_tokens": 2000
        }
        
        response = requests.post(
            self.api_url,
            headers={
                "Authorization": f"Bearer {self.api_key}",
                "Content-Type": "application/json"
            },
            json=payload,
            timeout=30
        )
        
        if response.status_code != 200:
            print(f"âŒ DeepSeek APIé”™è¯¯: {response.status_code}")
            return None
        
        result = response.json()
        ai_response = result['choices'][0]['message']['content']
        
        # 4. è§£æAIå“åº”ä¸ºJSON
        analysis = self._parse_ai_response(ai_response)
        
        return analysis
    
    def _build_system_prompt(self, style: str, language: str):
        """æ„å»ºç³»ç»Ÿæç¤ºè¯"""
        style_prompts = {
            "buffett": """ä½ æ˜¯ä¸€ä½éµå¾ªæ²ƒä¼¦Â·å·´è²ç‰¹ä»·å€¼æŠ•èµ„ç†å¿µçš„ä¸“ä¸šè‚¡ç¥¨åˆ†æå¸ˆã€‚
ä½ çš„åˆ†æç‰¹ç‚¹ï¼š
- å…³æ³¨ä¼ä¸šå†…åœ¨ä»·å€¼å’ŒæŠ¤åŸæ²³
- åå¥½é•¿æœŸæŒæœ‰ä¼˜è´¨ä¼ä¸š
- é‡è§†ç®¡ç†å±‚è´¨é‡å’Œå…¬å¸æ²»ç†
- å¼ºè°ƒå®‰å…¨è¾¹é™…""",
            
            "lynch": """ä½ æ˜¯ä¸€ä½éµå¾ªå½¼å¾—Â·æ—å¥‡æˆé•¿æŠ•èµ„ç†å¿µçš„ä¸“ä¸šè‚¡ç¥¨åˆ†æå¸ˆã€‚
ä½ çš„åˆ†æç‰¹ç‚¹ï¼š
- å¯»æ‰¾è¢«ä½ä¼°çš„æˆé•¿è‚¡
- å…³æ³¨å…¬å¸å¢é•¿æ½œåŠ›å’Œå¸‚åœºä»½é¢
- é‡è§†PEGæ¯”ç‡ï¼ˆå¸‚ç›ˆç‡ç›¸å¯¹ç›ˆåˆ©å¢é•¿æ¯”ç‡ï¼‰
- å–œæ¬¢"åå€è‚¡"æœºä¼š""",
            
            "soros": """ä½ æ˜¯ä¸€ä½éµå¾ªä¹”æ²»Â·ç´¢ç½—æ–¯å®è§‚äº¤æ˜“ç†å¿µçš„ä¸“ä¸šè‚¡ç¥¨åˆ†æå¸ˆã€‚
ä½ çš„åˆ†æç‰¹ç‚¹ï¼š
- å…³æ³¨å®è§‚ç»æµè¶‹åŠ¿å’Œå¸‚åœºæƒ…ç»ª
- é‡è§†å¸‚åœºåèº«æ€§ç†è®º
- æ•¢äºé€†å‘æŠ•èµ„å’Œåšç©º
- å¿«é€Ÿæ­¢æŸï¼Œä¿æŠ¤èµ„æœ¬"""
        }
        
        base_prompt = style_prompts.get(style, style_prompts["buffett"])
        
        if language == "en":
            base_prompt = base_prompt.replace("ä½ ", "You").replace("åˆ†æå¸ˆ", "analyst")
        
        return base_prompt
    
    def _build_user_prompt(self, symbol, current_data, history_data, rsi,
                          user_opinion, news_context, language):
        """æ„å»ºç”¨æˆ·æç¤ºè¯"""
        
        # è®¡ç®—ä»·æ ¼å˜åŒ–
        price_change_30d = 0
        if len(history_data) >= 30:
            old_price = history_data[-1]['close']
            new_price = current_data['price']
            price_change_30d = ((new_price - old_price) / old_price) * 100
        
        prompt = f"""
è¯·åˆ†æä»¥ä¸‹è‚¡ç¥¨æ•°æ®å¹¶ç»™å‡ºæŠ•èµ„å»ºè®®ï¼š

ã€è‚¡ç¥¨ä¿¡æ¯ã€‘
ä»£ç : {symbol}
å½“å‰ä»·æ ¼: ${current_data['price']:.2f}
ä»Šæ—¥æ¶¨è·Œ: {current_data['change']:+.2f} ({current_data['change_percent']:+.2f}%)
30å¤©æ¶¨è·Œ: {price_change_30d:+.2f}%
æˆäº¤é‡: {current_data['volume']:,}
RSIæŒ‡æ ‡: {rsi:.2f}

ã€å†å²æ•°æ®ã€‘ï¼ˆæœ€è¿‘5å¤©ï¼‰
"""
        for h in history_data[:5]:
            prompt += f"{h['date']}: ${h['close']:.2f} (æˆäº¤é‡: {h['volume']:,})\n"
        
        # æ·»åŠ ç”¨æˆ·è§‚ç‚¹
        if user_opinion:
            prompt += f"\nã€ç”¨æˆ·è§‚ç‚¹ã€‘\n{user_opinion}\n"
        
        # æ·»åŠ æ–°é—»æ¶ˆæ¯
        if news_context:
            prompt += f"\nã€ç›¸å…³æ–°é—»ã€‘\n{news_context}\n"
        
        prompt += """
è¯·ä»¥JSONæ ¼å¼è¿”å›åˆ†æç»“æœï¼ˆå¿…é¡»æ˜¯æœ‰æ•ˆçš„JSONï¼‰ï¼š
{
  "score": 0-100çš„ç»¼åˆè¯„åˆ†,
  "recommendation": "ä¹°å…¥/è§‚æœ›/å–å‡º",
  "position_size": "å»ºè®®ä»“ä½ï¼ˆå¦‚20%ï¼‰",
  "target_price": ç›®æ ‡ä»·æ ¼ï¼ˆæ•°å­—ï¼‰,
  "stop_loss": æ­¢æŸä»·æ ¼ï¼ˆæ•°å­—ï¼‰,
  "key_points": ["åˆ†æè¦ç‚¹1", "åˆ†æè¦ç‚¹2", "åˆ†æè¦ç‚¹3"],
  "analysis_summary": "ç»¼åˆåˆ†ææ€»ç»“ï¼ˆ2-3å¥è¯ï¼‰",
  "strategy": "å…·ä½“æŠ•èµ„ç­–ç•¥å’Œå»ºè®®ï¼ˆ3-5å¥è¯ï¼‰",
  "market_direction": "bullish/bearish/neutral",
  "direction_strength": "strong/moderate/weak"
}

æ³¨æ„ï¼š
1. å¿…é¡»ç»“åˆç”¨æˆ·è§‚ç‚¹å’Œæ–°é—»æ¶ˆæ¯è¿›è¡Œåˆ†æ
2. target_priceåº”è¯¥åŸºäºå½“å‰ä»·æ ¼å’Œå¸‚åœºè¶‹åŠ¿åˆç†è®¾å®š
3. stop_lossåº”è¯¥è®¾ç½®åœ¨åˆç†çš„é£é™©æ§åˆ¶ä½ç½®
4. æ‰€æœ‰å­—æ®µéƒ½å¿…é¡»å¡«å†™
"""
        
        return prompt
    
    def _parse_ai_response(self, response_text: str):
        """è§£æAIå“åº”ä¸ºJSON"""
        try:
            # å°è¯•æå–JSONï¼ˆå¯èƒ½è¢«markdownåŒ…è£¹ï¼‰
            if "```json" in response_text:
                json_str = response_text.split("```json")[1].split("```")[0].strip()
            elif "```" in response_text:
                json_str = response_text.split("```")[1].split("```")[0].strip()
            else:
                json_str = response_text.strip()
            
            analysis = json.loads(json_str)
            
            # éªŒè¯å¿…éœ€å­—æ®µ
            required_fields = ['score', 'recommendation', 'target_price', 'stop_loss']
            for field in required_fields:
                if field not in analysis:
                    raise ValueError(f"Missing field: {field}")
            
            return analysis
            
        except Exception as e:
            print(f"âŒ è§£æAIå“åº”å¤±è´¥: {e}")
            print(f"åŸå§‹å“åº”: {response_text[:200]}...")
            return None
```

**AIæç¤ºè¯å·¥ç¨‹è¦ç‚¹ï¼š**

1. **ç³»ç»Ÿæç¤ºè¯ï¼ˆSystem Promptï¼‰**
   - å®šä¹‰AIçš„è§’è‰²å’Œåˆ†æé£æ ¼
   - é’ˆå¯¹ä¸åŒæŠ•èµ„ç†å¿µï¼ˆå·´è²ç‰¹/æ—å¥‡/ç´¢ç½—æ–¯ï¼‰å®šåˆ¶

2. **ç”¨æˆ·æç¤ºè¯ï¼ˆUser Promptï¼‰**
   - æä¾›ç»“æ„åŒ–çš„è‚¡ç¥¨æ•°æ®
   - åŒ…å«ç”¨æˆ·è§‚ç‚¹å’Œæ–°é—»æ¶ˆæ¯
   - æ˜ç¡®è¦æ±‚JSONæ ¼å¼è¾“å‡º

3. **å“åº”è§£æ**
   - å¤„ç†markdownåŒ…è£¹çš„JSON
   - éªŒè¯å¿…éœ€å­—æ®µ
   - é”™è¯¯å®¹é”™å¤„ç†

---

## 5ï¸âƒ£ éƒ¨ç½²æ¶æ„

### 5.1 éƒ¨ç½²æµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            GitHub Repository                   â”‚
â”‚         (ä»£ç ä»“åº“ - å•ä¸€æ¥æº)                    â”‚
â”‚                                                â”‚
â”‚  â”œâ”€â”€ frontend/          (Reactå‰ç«¯ä»£ç )         â”‚
â”‚  â”œâ”€â”€ backend/           (Flaskåç«¯ä»£ç )         â”‚
â”‚  â”œâ”€â”€ package.json       (å‰ç«¯ä¾èµ–)             â”‚
â”‚  â”œâ”€â”€ requirements.txt   (åç«¯ä¾èµ–)             â”‚
â”‚  â””â”€â”€ README.md                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                           â”‚
         â”‚ git push                  â”‚ git push
         â”‚ (è‡ªåŠ¨è§¦å‘éƒ¨ç½²)             â”‚ (è‡ªåŠ¨è§¦å‘éƒ¨ç½²)
         â–¼                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Vercel (å‰ç«¯)      â”‚    â”‚  Render (åç«¯)       â”‚
â”‚                     â”‚    â”‚                      â”‚
â”‚  â€¢ è‡ªåŠ¨æ„å»ºReact     â”‚    â”‚  â€¢ è‡ªåŠ¨æ„å»ºDocker    â”‚
â”‚  â€¢ ä¼˜åŒ–æ‰“åŒ…         â”‚    â”‚  â€¢ å¯åŠ¨Flaskåº”ç”¨     â”‚
â”‚  â€¢ CDNå…¨çƒåŠ é€Ÿ      â”‚    â”‚  â€¢ PostgreSQLæ•°æ®åº“  â”‚
â”‚  â€¢ HTTPSåŠ å¯†        â”‚    â”‚  â€¢ è‡ªåŠ¨å¥åº·æ£€æŸ¥      â”‚
â”‚  â€¢ ç¯å¢ƒå˜é‡ç®¡ç†     â”‚    â”‚  â€¢ ç¯å¢ƒå˜é‡ç®¡ç†      â”‚
â”‚                     â”‚    â”‚                      â”‚
â”‚  URL:               â”‚    â”‚  URL:                â”‚
â”‚  vercel.app         â”‚    â”‚  onrender.com        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                           â”‚
          â”‚    HTTPSè¯·æ±‚ (JSONæ•°æ®)    â”‚
          â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
          â”‚         CORSå…è®¸            â”‚
          â”‚                           â”‚
          â–¼                           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ç”¨æˆ·æµè§ˆå™¨â”‚              â”‚ å¤–éƒ¨API       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚ - Alpha Vantageâ”‚
                             â”‚ - DeepSeek     â”‚
                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 5.2 ç¯å¢ƒå˜é‡é…ç½®

**æ¦‚å¿µè§£é‡Šï¼š** ç¯å¢ƒå˜é‡ç”¨äºå­˜å‚¨æ•æ„Ÿé…ç½®ï¼ˆAPIå¯†é’¥ã€æ•°æ®åº“URLï¼‰ï¼Œä¸å†™å…¥ä»£ç æ›´å®‰å…¨ã€‚

#### å‰ç«¯ç¯å¢ƒå˜é‡ï¼ˆVercelï¼‰

```bash
# .env.production
REACT_APP_API_URL=https://decision-assistant-b.onrender.com
```

**åœ¨Vercel Dashboardé…ç½®ï¼š**
```
Settings â†’ Environment Variables

Key: REACT_APP_API_URL
Value: https://decision-assistant-b.onrender.com
Environment: Production
```

#### åç«¯ç¯å¢ƒå˜é‡ï¼ˆRenderï¼‰

```bash
# Render Dashboardé…ç½®
DATABASE_URL=postgresql://user:password@dpg-xxx.singapore-postgres.render.com/database
ALPHA_VANTAGE_API_KEY=OIYWUJEPSR9RQAGU
DEEPSEEK_API_KEY=sk-d3196d8e68c44690998d79c715ce715d
PORT=10000
PYTHON_VERSION=3.11.0
```

**åœ¨Render Dashboardé…ç½®ï¼š**
```
Environment â†’ Environment Variables

Key                      Value
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
DATABASE_URL            postgresql://user:password@...
ALPHA_VANTAGE_API_KEY   OIYWUJEPSR9RQAGU
DEEPSEEK_API_KEY        sk-d3196d8e68c44690998d79c715ce715d
PORT                    10000
```

---

### 5.3 CORSé…ç½®è¯¦è§£

**é—®é¢˜ï¼š** æµè§ˆå™¨é»˜è®¤ç¦æ­¢è·¨åŸŸè¯·æ±‚ï¼ˆå‰ç«¯åœ¨`vercel.app`ï¼Œåç«¯åœ¨`render.com`ï¼‰

**è§£å†³æ–¹æ¡ˆï¼š** åœ¨åç«¯é…ç½®CORSå…è®¸è·¨åŸŸ

```python
# backend/app.py
from flask import Flask
from flask_cors import CORS

app = Flask(__name__)

# CORSé…ç½®
CORS(app, 
     resources={
         r"/*": {  # å…è®¸æ‰€æœ‰è·¯ç”±
             "origins": "*",  # å…è®¸æ‰€æœ‰æ¥æºï¼ˆç”Ÿäº§ç¯å¢ƒå¯é™åˆ¶ä¸ºå‰ç«¯åŸŸåï¼‰
             "methods": ["GET", "POST", "PUT", "DELETE", "OPTIONS"],
             "allow_headers": ["Content-Type", "Authorization"],
             "supports_credentials": False
         }
     })
```

**OPTIONSé¢„æ£€è¯·æ±‚å¤„ç†ï¼š**

```python
# æ¯ä¸ªè·¯ç”±éƒ½éœ€è¦å¤„ç†OPTIONS
@stock_bp.route('/analyze', methods=['POST', 'OPTIONS'])
def analyze_stock():
    # CORSé¢„æ£€è¯·æ±‚
    if request.method == 'OPTIONS':
        return jsonify({"status": "ok"}), 200
    
    # æ­£å¸¸çš„POSTå¤„ç†
    data = request.json
    # ...
```

**CORSå·¥ä½œæµç¨‹ï¼š**

```
1. æµè§ˆå™¨å‘é€OPTIONSé¢„æ£€è¯·æ±‚
   OPTIONS /api/stock/analyze
   Origin: https://decision-assistant-frontend-prod.vercel.app
   
2. åç«¯è¿”å›CORSå¤´
   HTTP/1.1 200 OK
   Access-Control-Allow-Origin: *
   Access-Control-Allow-Methods: POST, OPTIONS
   Access-Control-Allow-Headers: Content-Type
   
3. æµè§ˆå™¨å‘é€å®é™…POSTè¯·æ±‚
   POST /api/stock/analyze
   Content-Type: application/json
   Body: {"symbol": "AAPL", ...}
   
4. åç«¯è¿”å›æ•°æ®
   HTTP/1.1 200 OK
   Access-Control-Allow-Origin: *
   Content-Type: application/json
   Body: {"status": "success", ...}
```

---

## 6ï¸âƒ£ å®Œæ•´æ•°æ®æµç¤ºä¾‹

### åœºæ™¯ï¼šç”¨æˆ·ç‚¹å‡»"åˆ†æè‚¡ç¥¨"æŒ‰é’®

è®©æˆ‘ä»¬è·Ÿè¸ªä¸€æ¬¡å®Œæ•´çš„è¯·æ±‚ä»å‰ç«¯åˆ°åç«¯å†å›åˆ°å‰ç«¯çš„å…¨è¿‡ç¨‹ã€‚

#### ã€æ­¥éª¤1ã€‘å‰ç«¯ - ç”¨æˆ·äº¤äº’

```javascript
// frontend/src/StockAnalysis.js

// ç”¨æˆ·ç‚¹å‡»"åˆ†æ"æŒ‰é’®
<button onClick={analyzeStock}>
  ğŸ¤– AIåˆ†æ
</button>

const analyzeStock = async () => {
  if (!stockData) {
    setError('è¯·å…ˆæœç´¢è‚¡ç¥¨');
    return;
  }

  setLoading(true);  // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
  setError('');
  setAnalysis(null);

  try {
    // ğŸ“¤ å‘é€HTTP POSTè¯·æ±‚åˆ°åç«¯
    const response = await fetch(`${apiUrl}/api/stock/analyze`, {
      method: 'POST',
      headers: { 
        'Content-Type': 'application/json' 
      },
      body: JSON.stringify({
        symbol: stockData.quote.symbol,        // "AAPL"
        investment_style: investmentStyle,     // "buffett"
        news_context: newsContext,             // "è‹¹æœå‘å¸ƒæ–°äº§å“..."
        user_opinion: userOpinion,             // "æˆ‘çœ‹å¥½è¿™åªè‚¡ç¥¨"
        language: language                     // "zh"
      })
    });

    // ğŸ“¥ æ¥æ”¶åç«¯å“åº”
    const result = await response.json();

    if (result.status === 'success') {
      // âœ… æ›´æ–°UIçŠ¶æ€
      setAnalysis(result.analysis);
      
      if (result.option_strategy) {
        setOptionStrategy(result.option_strategy);
      }
    } else {
      setError('AIåˆ†æå¤±è´¥: ' + result.message);
    }

  } catch (err) {
    setError('ç½‘ç»œè¿æ¥å¤±è´¥: ' + err.message);
  } finally {
    setLoading(false);  // éšè—åŠ è½½çŠ¶æ€
  }
};
```

---

#### ã€æ­¥éª¤2ã€‘åç«¯ - æ¥æ”¶è¯·æ±‚

```python
# backend/stock_analysis_api.py

@stock_bp.route('/analyze', methods=['POST', 'OPTIONS'])
def analyze_stock():
    """AIåˆ†æè‚¡ç¥¨"""
    
    # CORSé¢„æ£€å¤„ç†
    if request.method == 'OPTIONS':
        return jsonify({"status": "ok"}), 200
    
    # ğŸ“¥ è§£æè¯·æ±‚æ•°æ®
    data = request.json
    symbol = data.get('symbol', '').upper()           # "AAPL"
    investment_style = data.get('investment_style')   # "buffett"
    user_opinion = data.get('user_opinion', '').strip()
    news_context = data.get('news_context', '').strip()
    language = data.get('language', 'zh')
    
    print(f"ğŸ¤– å¼€å§‹åˆ†æ: {symbol}")
    print(f"   ğŸ“ ç”¨æˆ·è§‚ç‚¹: {user_opinion[:50]}...")
    print(f"   ğŸ“° æ–°é—»æ¶ˆæ¯: {news_context[:50]}...")
    
    # å‚æ•°éªŒè¯
    if not symbol:
        return jsonify({
            "status": "error",
            "message": "è¯·æä¾›è‚¡ç¥¨ä»£ç "
        }), 400
```

---

#### ã€æ­¥éª¤3ã€‘è°ƒç”¨Alpha Vantageè·å–è‚¡ä»·

```python
    # ğŸ” è·å–è‚¡ç¥¨æ•°æ®
    client = get_alpha_vantage_client()
    
    # å®æ—¶æŠ¥ä»·
    quote = client.get_quote(symbol)
    # quote = {
    #     "symbol": "AAPL",
    #     "price": 178.50,
    #     "change": 2.30,
    #     "change_percent": 1.31,
    #     "volume": 50000000
    # }
    
    if not quote:
        return jsonify({
            "status": "error",
            "message": f"æœªæ‰¾åˆ°è¯¥è‚¡ç¥¨: {symbol}"
        }), 404
    
    # å†å²æ•°æ®ï¼ˆ30å¤©ï¼‰
    history = client.get_daily_history(symbol, days=30)
    # history = [
    #     {"date": "2025-11-04", "close": 178.50, "volume": 50000000},
    #     {"date": "2025-11-03", "close": 176.20, "volume": 48000000},
    #     ...
    # ]
    
    # è®¡ç®—RSIæŒ‡æ ‡
    closes = [h['close'] for h in history]
    rsi = calculate_rsi(closes)  # 58.3
    
    # ğŸ†• è·å–Premiumæ•°æ®
    company_overview = client.get_company_overview(symbol)
    macd_data = client.get_technical_indicator(symbol, 'MACD')
    bbands_data = client.get_technical_indicator(symbol, 'BBANDS')
    cpi_data = client.get_economic_indicator('CPI')
    
    print(f"âœ… æ•°æ®è·å–å®Œæˆ")
```

---

#### ã€æ­¥éª¤4ã€‘è°ƒç”¨DeepSeek AIåˆ†æ

```python
    # ğŸ¤– AIåˆ†æ
    analyzer = get_stock_analyzer()
    
    analysis = analyzer.analyze_stock(
        symbol=symbol,
        current_data=quote,
        history_data=history,
        rsi=rsi,
        investment_style=investment_style,
        user_opinion=user_opinion,
        news_context=news_context,
        language=language,
        company_overview=company_overview,
        technical_indicators={'macd': macd_data, 'bbands': bbands_data},
        economic_data={'cpi': cpi_data}
    )
    # analysis = {
    #     "score": 75,
    #     "recommendation": "ä¹°å…¥",
    #     "position_size": "20%",
    #     "target_price": 190.0,
    #     "stop_loss": 175.0,
    #     "key_points": ["æŠ€æœ¯é¢å¼ºåŠ¿...", "RSIå¥åº·...", "æˆäº¤é‡æ”¾å¤§..."],
    #     "analysis_summary": "ç»¼åˆæ¥çœ‹ï¼Œè¯¥è‚¡ç¥¨...",
    #     "strategy": "å»ºè®®é‡‡ç”¨ä»·å€¼æŠ•èµ„ç­–ç•¥...",
    #     "market_direction": "bullish",
    #     "direction_strength": "strong"
    # }
    
    if not analysis:
        return jsonify({
            "status": "error",
            "message": "AIåˆ†æå¤±è´¥"
        }), 500
    
    print(f"âœ… AIåˆ†æå®Œæˆ: è¯„åˆ†{analysis['score']}, å»ºè®®{analysis['recommendation']}")
```

---

#### ã€æ­¥éª¤5ã€‘ç”ŸæˆæœŸæƒç­–ç•¥

```python
    # ğŸ¯ ç”ŸæˆæœŸæƒç­–ç•¥
    option_strategy = None
    
    if analysis.get('market_direction') and analysis.get('direction_strength'):
        from option_strategy_handler import OptionStrategyHandler
        
        # æ„å»ºæœŸæƒç­–ç•¥è¯·æ±‚
        direction_map = {'bullish': 'çœ‹æ¶¨', 'bearish': 'çœ‹è·Œ', 'neutral': 'éœ‡è¡'}
        strength_map = {'strong': 'å¼ºçƒˆ', 'moderate': 'ä¸€èˆ¬', 'weak': 'ç•¥å¾®'}
        
        direction_cn = direction_map.get(analysis['market_direction'], 'éœ‡è¡')
        strength_cn = strength_map.get(analysis['direction_strength'], 'ä¸€èˆ¬')
        
        option_text = f"æˆ‘{strength_cn}{direction_cn}{symbol}è‚¡ç¥¨"
        
        handler = OptionStrategyHandler()
        option_result = handler.handle_option_strategy_request(
            option_text,
            current_price=quote['price']
        )
        
        if option_result['success']:
            option_strategy = option_result['strategy']
            # option_strategy = {
            #     "name": "ä¹°å…¥çœ‹æ¶¨æœŸæƒ",
            #     "type": "call",
            #     "description": "é€‚åˆçœ‹æ¶¨è¡Œæƒ…...",
            #     "strike": 180.0,
            #     "expiry": "2025-01-17",
            #     "payoff_diagram": [...]
            # }
            
            print(f"âœ… æœŸæƒç­–ç•¥: {option_strategy['name']}")
```

---

#### ã€æ­¥éª¤6ã€‘è¿”å›ç»“æœç»™å‰ç«¯

```python
    # ğŸ“¤ è¿”å›JSONå“åº”
    response_data = {
        "status": "success",
        "analysis": analysis,
        "option_strategy": option_strategy
    }
    
    return jsonify(response_data), 200
```

---

#### ã€æ­¥éª¤7ã€‘å‰ç«¯ - æ˜¾ç¤ºç»“æœ

```javascript
// ğŸ“¥ æ¥æ”¶åˆ°åç«¯å“åº”åï¼Œè‡ªåŠ¨æ‰§è¡Œ
if (result.status === 'success') {
  // æ›´æ–°ReactçŠ¶æ€ï¼Œè§¦å‘UIé‡æ–°æ¸²æŸ“
  setAnalysis(result.analysis);
  setOptionStrategy(result.option_strategy);
}

// Reactè‡ªåŠ¨æ¸²æŸ“UI
{analysis && (
  <div className="analysis-result">
    <h3>ğŸ“Š AIåˆ†æç»“æœ</h3>
    
    {/* è¯„åˆ† */}
    <div className="score">
      è¯„åˆ†: {analysis.score}/100
    </div>
    
    {/* å»ºè®® */}
    <div className="recommendation">
      å»ºè®®: {analysis.recommendation}
      {analysis.recommendation === 'ä¹°å…¥' && 'ğŸŸ¢'}
      {analysis.recommendation === 'è§‚æœ›' && 'ğŸŸ¡'}
      {analysis.recommendation === 'å–å‡º' && 'ğŸ”´'}
    </div>
    
    {/* ç›®æ ‡ä»·å’Œæ­¢æŸ */}
    <div>
      ç›®æ ‡ä»·: ${analysis.target_price}
      æ­¢æŸä»·: ${analysis.stop_loss}
      å»ºè®®ä»“ä½: {analysis.position_size}
    </div>
    
    {/* åˆ†æè¦ç‚¹ */}
    <ul>
      {analysis.key_points.map((point, i) => (
        <li key={i}>{point}</li>
      ))}
    </ul>
    
    {/* ç»¼åˆåˆ†æ */}
    <p>{analysis.analysis_summary}</p>
    
    {/* æŠ•èµ„ç­–ç•¥ */}
    <p>{analysis.strategy}</p>
  </div>
)}

{/* æœŸæƒç­–ç•¥ */}
{optionStrategy && (
  <div className="option-strategy">
    <h3>ğŸ¯ æœŸæƒç­–ç•¥æ¨è</h3>
    <div>ç­–ç•¥: {optionStrategy.name}</div>
    <div>è¯´æ˜: {optionStrategy.description}</div>
    <div>æ‰§è¡Œä»·: ${optionStrategy.strike}</div>
    <div>åˆ°æœŸæ—¥: {optionStrategy.expiry}</div>
    
    {/* æŸç›Šå›¾ */}
    <LineChart data={optionStrategy.payoff_diagram}>
      ...
    </LineChart>
    
    {/* æ¥å—ç­–ç•¥æŒ‰é’® */}
    <button onClick={acceptStrategy}>
      âœ… æ¥å—æ­¤ç­–ç•¥
    </button>
  </div>
)}
```

---

### å®Œæ•´æ—¶é—´çº¿

```
æ—¶é—´çº¿ï¼ˆæ€»è€—æ—¶çº¦ 3-5 ç§’ï¼‰ï¼š

0ms    ç”¨æˆ·ç‚¹å‡»"åˆ†æ"æŒ‰é’®
       â†“
10ms   å‰ç«¯å‘é€POSTè¯·æ±‚åˆ°åç«¯
       â†“
100ms  åç«¯æ¥æ”¶è¯·æ±‚ï¼Œè§£æå‚æ•°
       â†“
500ms  è°ƒç”¨Alpha Vantage APIè·å–è‚¡ç¥¨æ•°æ®ï¼ˆå®æ—¶æŠ¥ä»·ã€å†å²æ•°æ®ã€æŠ€æœ¯æŒ‡æ ‡ï¼‰
       â†“
2000ms è°ƒç”¨DeepSeek AIè¿›è¡Œåˆ†æï¼ˆæœ€è€—æ—¶ï¼‰
       â†“
2500ms ç”ŸæˆæœŸæƒç­–ç•¥ï¼ˆåŸºäºAIåˆ†æç»“æœï¼‰
       â†“
2600ms åç«¯è¿”å›JSONå“åº”
       â†“
2610ms å‰ç«¯æ¥æ”¶å“åº”ï¼Œè§£æJSON
       â†“
2620ms Reactæ›´æ–°çŠ¶æ€ï¼Œè§¦å‘é‡æ–°æ¸²æŸ“
       â†“
2650ms ç”¨æˆ·çœ‹åˆ°å®Œæ•´çš„åˆ†æç»“æœå’ŒæœŸæƒç­–ç•¥
```

---

## 7ï¸âƒ£ æ ¸å¿ƒæ¦‚å¿µæ€»ç»“

### 7.1 æŠ€æœ¯æœ¯è¯­å¯¹ç…§è¡¨

| ä¸“ä¸šæœ¯è¯­ | é€šä¿—è§£é‡Š | ç±»æ¯” | åœ¨æœ¬é¡¹ç›®ä¸­çš„åº”ç”¨ |
|---------|---------|------|-----------------|
| **Componentï¼ˆç»„ä»¶ï¼‰** | ç‹¬ç«‹çš„UIæ¨¡å— | ä¹é«˜ç§¯æœ¨ | `StockAnalysis`, `StrategyEvaluation` |
| **Stateï¼ˆçŠ¶æ€ï¼‰** | ç»„ä»¶çš„"è®°å¿†" | å˜é‡ | `symbol`, `stockData`, `loading` |
| **Propsï¼ˆå±æ€§ï¼‰** | ç»„ä»¶é—´ä¼ é€’çš„æ•°æ® | å‡½æ•°å‚æ•° | `apiUrl`, `language` |
| **Hookï¼ˆé’©å­ï¼‰** | ReactåŠŸèƒ½æ‰©å±• | æ’ä»¶ | `useState`, `useEffect`, `useCallback` |
| **API** | åç«¯æä¾›çš„"æ¥å£" | é¤å…èœå• | `/api/stock/AAPL`, `/api/stock/analyze` |
| **Routeï¼ˆè·¯ç”±ï¼‰** | URLåˆ°å‡½æ•°çš„æ˜ å°„ | åœ°å€â†’ç›®çš„åœ° | `/api/stock/<symbol>` â†’ `get_stock_data()` |
| **Blueprintï¼ˆè“å›¾ï¼‰** | è·¯ç”±æ¨¡å— | ä¹¦çš„ç« èŠ‚ | `stock_bp`, `algorithm_bp` |
| **JSON** | æ•°æ®äº¤æ¢æ ¼å¼ | é€šç”¨è¯­è¨€ | `{"status": "success", "data": {...}}` |
| **HTTPæ–¹æ³•** | è¯·æ±‚ç±»å‹ | åŠ¨ä½œç±»å‹ | GET(æŸ¥è¯¢), POST(æäº¤), DELETE(åˆ é™¤) |
| **CORS** | è·¨åŸŸè®¸å¯è¯ | é€šè¡Œè¯ | å…è®¸vercel.appè®¿é—®render.com |
| **Databaseï¼ˆæ•°æ®åº“ï¼‰** | æ•°æ®æ°¸ä¹…å­˜å‚¨ | æ–‡ä»¶æŸœ | PostgreSQLå­˜å‚¨ç”¨æˆ·å’Œç­–ç•¥ |
| **SQL** | æ•°æ®åº“æŸ¥è¯¢è¯­è¨€ | æ£€ç´¢æŒ‡ä»¤ | `SELECT`, `INSERT`, `UPDATE`, `DELETE` |
| **JSONB** | JSONæ•°æ®ç±»å‹ | çµæ´»çš„æ ¼å¼ | å­˜å‚¨ç­–ç•¥åˆ—è¡¨ï¼ˆæ•°ç»„/å¯¹è±¡ï¼‰ |
| **ç¯å¢ƒå˜é‡** | é…ç½®ä¿¡æ¯ | è®¾ç½®æ–‡ä»¶ | APIå¯†é’¥ã€æ•°æ®åº“URL |
| **éƒ¨ç½²** | ä¸Šçº¿åˆ°äº’è”ç½‘ | å¼€ä¸š | Vercel(å‰ç«¯) + Render(åç«¯) |
| **ç¼“å­˜** | ä¸´æ—¶å­˜å‚¨æ•°æ® | å¤‡å¿˜å½• | Alpha Vantageæ•°æ®ç¼“å­˜15åˆ†é’Ÿ |
| **å¼‚æ­¥æ“ä½œ** | ç­‰å¾…è€—æ—¶ä»»åŠ¡ | å¤–å–è®¢å• | `async/await`, APIè°ƒç”¨ |

---

### 7.2 æ•°æ®æµå‘å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç”¨æˆ·æ“ä½œæµç¨‹                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. ç”¨æˆ·è¾“å…¥è‚¡ç¥¨ä»£ç  "AAPL"
   â†“
2. ç‚¹å‡»"æœç´¢"æŒ‰é’®
   â†“
3. å‰ç«¯å‘é€ GET /api/stock/AAPL
   â†“
4. åç«¯è°ƒç”¨ Alpha Vantage API
   â†“
5. è¿”å›è‚¡ç¥¨æ•°æ®ï¼ˆä»·æ ¼ã€å†å²ã€æŠ€æœ¯æŒ‡æ ‡ï¼‰
   â†“
6. å‰ç«¯æ˜¾ç¤ºKçº¿å›¾ã€æ•°æ®é¢æ¿
   â†“
7. ç”¨æˆ·é€‰æ‹©æŠ•èµ„é£æ ¼ï¼ˆå·´è²ç‰¹ï¼‰
   â†“
8. ç”¨æˆ·è¾“å…¥è§‚ç‚¹å’Œæ–°é—»
   â†“
9. ç‚¹å‡»"AIåˆ†æ"æŒ‰é’®
   â†“
10. å‰ç«¯å‘é€ POST /api/stock/analyze
    â†“
11. åç«¯è°ƒç”¨ DeepSeek AI
    â†“
12. åç«¯ç”ŸæˆæœŸæƒç­–ç•¥
    â†“
13. è¿”å›åˆ†æç»“æœ + æœŸæƒç­–ç•¥
    â†“
14. å‰ç«¯æ˜¾ç¤ºåˆ†ææŠ¥å‘Šå’ŒæœŸæƒæ¨è
    â†“
15. ç”¨æˆ·ç‚¹å‡»"æ¥å—ç­–ç•¥"
    â†“
16. å‰ç«¯å‘é€ POST /api/user/save-strategy
    â†“
17. åç«¯ä¿å­˜åˆ°æ•°æ®åº“ï¼ˆusers.accepted_strategiesï¼‰
    â†“
18. è¿”å›æˆåŠŸæ¶ˆæ¯
    â†“
19. å‰ç«¯æç¤º"ç­–ç•¥å·²ä¿å­˜"
    â†“
20. ç”¨æˆ·åˆ‡æ¢åˆ°"ç­–ç•¥è¯„ä¼°"é¡µé¢
    â†“
21. å‰ç«¯å‘é€ GET /api/user/bbb/strategies
    â†“
22. åç«¯ä»æ•°æ®åº“æŸ¥è¯¢ç”¨æˆ·ç­–ç•¥
    â†“
23. è¿”å›ç­–ç•¥åˆ—è¡¨
    â†“
24. å‰ç«¯æ˜¾ç¤ºå†å²ç­–ç•¥å¡ç‰‡
    â†“
25. ç”¨æˆ·ç‚¹å‡»æŸä¸ªç­–ç•¥"è¯„ä¼°"
    â†“
26. å‰ç«¯å‘é€ POST /api/strategy/evaluate
    â†“
27. åç«¯è·å–å½“å‰è‚¡ä»·ï¼ˆAlpha Vantageï¼‰
    â†“
28. è®¡ç®—æ”¶ç›Šç‡ã€è¾¾æ ‡æƒ…å†µ
    â†“
29. è¿”å›è¯„ä¼°ç»“æœ
    â†“
30. å‰ç«¯æ˜¾ç¤ºå®æ—¶è¡¨ç°ï¼ˆæ”¶ç›Šç‡ã€é£é™©çŠ¶æ€ï¼‰
```

---

### 7.3 é¡¹ç›®æ–‡ä»¶ç»“æ„

```
decision-assistant-githubV3/
â”‚
â”œâ”€â”€ frontend/                          # å‰ç«¯ä»£ç ï¼ˆReactï¼‰
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ App.js                    # ä¸»åº”ç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ StockAnalysis.js          # è‚¡ç¥¨åˆ†æç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ StrategyEvaluation.js     # ç­–ç•¥è¯„ä¼°ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ChatMode.js               # èŠå¤©æ¨¡å¼ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ i18n.js                   # å›½é™…åŒ–é…ç½®
â”‚   â”‚   â”œâ”€â”€ App.css                   # æ ·å¼æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ index.js                  # å…¥å£æ–‡ä»¶
â”‚   â”œâ”€â”€ public/
â”‚   â”‚   â””â”€â”€ index.html                # HTMLæ¨¡æ¿
â”‚   â”œâ”€â”€ package.json                  # å‰ç«¯ä¾èµ–
â”‚   â””â”€â”€ vite.config.js                # Viteæ„å»ºé…ç½®
â”‚
â”œâ”€â”€ backend/                           # åç«¯ä»£ç ï¼ˆFlaskï¼‰
â”‚   â”œâ”€â”€ app.py                        # ä¸»åº”ç”¨æ–‡ä»¶
â”‚   â”œâ”€â”€ stock_analysis_api.py         # è‚¡ç¥¨åˆ†æAPIè·¯ç”±
â”‚   â”œâ”€â”€ algorithm_api.py              # ç®—æ³•åˆ†æAPIè·¯ç”±
â”‚   â”‚
â”‚   â”œâ”€â”€ stock_analysis/               # è‚¡ç¥¨åˆ†ææ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ alpha_vantage_client.py  # Alpha Vantageå®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ stock_analyzer.py        # AIåˆ†æå™¨
â”‚   â”‚   â””â”€â”€ investment_styles.py     # æŠ•èµ„é£æ ¼å®šä¹‰
â”‚   â”‚
â”‚   â”œâ”€â”€ database/                     # æ•°æ®åº“æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ connection.py            # æ•°æ®åº“è¿æ¥
â”‚   â”‚   â”œâ”€â”€ models.py                # æ•°æ®æ¨¡å‹
â”‚   â”‚   â””â”€â”€ api.py                   # æ•°æ®åº“API
â”‚   â”‚
â”‚   â”œâ”€â”€ option_strategy_handler.py   # æœŸæƒç­–ç•¥å¤„ç†å™¨
â”‚   â”œâ”€â”€ auto_migrate.py              # æ•°æ®åº“è‡ªåŠ¨è¿ç§»
â”‚   â”œâ”€â”€ requirements.txt             # Pythonä¾èµ–
â”‚   â””â”€â”€ Dockerfile                   # Dockeré…ç½®
â”‚
â”œâ”€â”€ 20251104_é¡¹ç›®æ€»ç»“.md              # æœ¬æ–‡æ¡£
â”œâ”€â”€ README.md                         # é¡¹ç›®è¯´æ˜
â””â”€â”€ .gitignore                        # Gitå¿½ç•¥æ–‡ä»¶
```

---

### 7.4 å…³é”®APIç«¯ç‚¹æ€»è§ˆ

| ç«¯ç‚¹ | æ–¹æ³• | åŠŸèƒ½ | è¯·æ±‚ | å“åº” |
|------|------|------|------|------|
| `/api/stock/search` | GET | æœç´¢è‚¡ç¥¨ | `?keywords=apple` | è‚¡ç¥¨åˆ—è¡¨ |
| `/api/stock/{symbol}` | GET | è·å–è‚¡ç¥¨æ•°æ® | è·¯å¾„å‚æ•° | æŠ¥ä»·+å†å²+æŒ‡æ ‡ |
| `/api/stock/analyze` | POST | AIåˆ†æ | JSON(symbol, style, opinion) | åˆ†æç»“æœ+æœŸæƒç­–ç•¥ |
| `/api/user/save-strategy` | POST | ä¿å­˜ç­–ç•¥ | JSON(username, strategy) | æˆåŠŸæ¶ˆæ¯ |
| `/api/user/{user}/strategies` | GET | è·å–ç”¨æˆ·ç­–ç•¥ | è·¯å¾„å‚æ•° | ç­–ç•¥åˆ—è¡¨ |
| `/api/user/{user}/strategies/{id}` | DELETE | åˆ é™¤ç­–ç•¥ | è·¯å¾„å‚æ•° | æˆåŠŸæ¶ˆæ¯ |
| `/api/strategy/evaluate` | POST | è¯„ä¼°ç­–ç•¥ | JSON(strategy_id, symbol) | å®æ—¶è¯„ä¼°ç»“æœ |

---

### 7.5 æŠ€æœ¯æ ˆç‰ˆæœ¬

| æŠ€æœ¯ | ç‰ˆæœ¬ | è¯´æ˜ |
|------|------|------|
| **React** | 18.2.0 | å‰ç«¯æ¡†æ¶ |
| **Recharts** | 2.5.0 | å›¾è¡¨åº“ |
| **Flask** | 3.0.0 | åç«¯æ¡†æ¶ |
| **Flask-CORS** | 4.0.0 | CORSæ”¯æŒ |
| **psycopg2** | 2.9.9 | PostgreSQLé©±åŠ¨ |
| **requests** | 2.31.0 | HTTPå®¢æˆ·ç«¯ |
| **Python** | 3.11 | ç¼–ç¨‹è¯­è¨€ |
| **Node.js** | 18.x | JavaScriptè¿è¡Œæ—¶ |
| **PostgreSQL** | 15 | æ•°æ®åº“ |

---

## 8ï¸âƒ£ æœ€ä½³å®è·µä¸ç»éªŒæ€»ç»“

### 8.1 å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

#### é—®é¢˜1ï¼šCORSè·¨åŸŸé”™è¯¯

**ç°è±¡ï¼š**
```
Access to fetch at 'https://render.com/api/...' from origin 
'https://vercel.app' has been blocked by CORS policy
```

**è§£å†³ï¼š**
```python
# åç«¯é…ç½®CORS
from flask_cors import CORS
CORS(app, resources={r"/*": {"origins": "*"}})

# æ¯ä¸ªè·¯ç”±å¤„ç†OPTIONS
@app.route('/api/...', methods=['POST', 'OPTIONS'])
def route_handler():
    if request.method == 'OPTIONS':
        return jsonify({"status": "ok"}), 200
```

---

#### é—®é¢˜2ï¼šè·¯ç”±404é”™è¯¯

**ç°è±¡ï¼š**
```
POST /api/strategy/evaluate â†’ 404 Not Found
```

**åŸå› ï¼š**
- è·¯ç”±é¡ºåºé”™è¯¯ï¼ˆé€šç”¨è·¯ç”±åœ¨å‰ï¼‰
- Blueprintæœªæ³¨å†Œæˆ–è¢«è¦†ç›–

**è§£å†³ï¼š**
```python
# âœ… æ­£ç¡®ï¼šå…·ä½“è·¯ç”±åœ¨å‰
@bp.route('/search', ...)
@bp.route('/trending', ...)
@bp.route('/<symbol>', ...)  # é€šç”¨è·¯ç”±æ”¾æœ€å

# âŒ é”™è¯¯ï¼šBlueprinté‡å¤æ³¨å†Œ
app.register_blueprint(old_bp)  # æ—§çš„blueprintè¦†ç›–æ–°è·¯ç”±
```

---

#### é—®é¢˜3ï¼šæ•°æ®åº“è¿æ¥å¤±è´¥

**ç°è±¡ï¼š**
```
psycopg2.OperationalError: could not connect to server
```

**è§£å†³ï¼š**
```python
# 1. æ£€æŸ¥ç¯å¢ƒå˜é‡
DATABASE_URL = os.getenv('DATABASE_URL')
print(f"Database URL: {DATABASE_URL[:30]}...")

# 2. é”™è¯¯å¤„ç†
try:
    conn = psycopg2.connect(DATABASE_URL)
except psycopg2.OperationalError as e:
    print(f"âŒ æ•°æ®åº“è¿æ¥å¤±è´¥: {e}")
    return jsonify({"error": "Database unavailable"}), 503
```

---

#### é—®é¢˜4ï¼šAPIé™æµ

**ç°è±¡ï¼š**
```
Alpha Vantageè¿”å›ï¼š{"Note": "Thank you for using Alpha Vantage! 
Our standard API call frequency is 5 calls per minute..."}
```

**è§£å†³ï¼š**
```python
# å®ç°ç¼“å­˜æœºåˆ¶
class AlphaVantageClient:
    def __init__(self):
        self.cache = {}
        self.cache_ttl = 900  # 15åˆ†é’Ÿç¼“å­˜
    
    def get_quote(self, symbol):
        cache_key = f"QUOTE:{symbol}"
        
        # æ£€æŸ¥ç¼“å­˜
        if self._is_cache_valid(cache_key):
            return self.cache[cache_key]['data']
        
        # è°ƒç”¨API
        data = self._fetch_from_api(symbol)
        
        # ä¿å­˜ç¼“å­˜
        self._set_cache(cache_key, data)
        
        return data
```

---

### 8.2 æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **å‰ç«¯ä¼˜åŒ–**
   - ä½¿ç”¨`React.memo`é¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“
   - å›¾è¡¨æ•°æ®æŒ‰éœ€åŠ è½½ï¼ˆæ‡’åŠ è½½ï¼‰
   - å›¾ç‰‡ä½¿ç”¨CDN

2. **åç«¯ä¼˜åŒ–**
   - APIå“åº”ç¼“å­˜ï¼ˆRedisï¼‰
   - æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–ï¼ˆç´¢å¼•ï¼‰
   - å¼‚æ­¥å¤„ç†è€—æ—¶ä»»åŠ¡

3. **æ•°æ®åº“ä¼˜åŒ–**
   - JSONBå­—æ®µæ·»åŠ GINç´¢å¼•
   - å®šæœŸæ¸…ç†è¿‡æœŸæ•°æ®
   - è¿æ¥æ± ç®¡ç†

---

### 8.3 å®‰å…¨å»ºè®®

1. **APIå¯†é’¥ä¿æŠ¤**
   - æ°¸è¿œä¸è¦æäº¤åˆ°Git
   - ä½¿ç”¨ç¯å¢ƒå˜é‡
   - å®šæœŸè½®æ¢å¯†é’¥

2. **SQLæ³¨å…¥é˜²æŠ¤**
   - ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢ï¼ˆ`%s`å ä½ç¬¦ï¼‰
   - æ°¸è¿œä¸è¦æ‹¼æ¥SQLå­—ç¬¦ä¸²

3. **ç”¨æˆ·è®¤è¯**
   - å¯†ç å“ˆå¸Œå­˜å‚¨ï¼ˆbcryptï¼‰
   - JWT tokenéªŒè¯
   - HTTPSåŠ å¯†ä¼ è¾“

---

## 9ï¸âƒ£ ç»“è¯­

è¿™ä¸ªé¡¹ç›®ç»¼åˆè¿ç”¨äº†ç°ä»£Webå¼€å‘çš„æ ¸å¿ƒæŠ€æœ¯æ ˆï¼š

- **å‰ç«¯ï¼š** Reactç”Ÿæ€ï¼ˆç»„ä»¶åŒ–ã€çŠ¶æ€ç®¡ç†ã€è·¯ç”±ï¼‰
- **åç«¯ï¼š** Flaskæ¡†æ¶ï¼ˆRESTful APIã€è“å›¾æ¨¡å—åŒ–ï¼‰
- **æ•°æ®åº“ï¼š** PostgreSQLï¼ˆå…³ç³»å‹å­˜å‚¨ã€JSONBçµæ´»æ€§ï¼‰
- **å¤–éƒ¨é›†æˆï¼š** Alpha Vantageï¼ˆé‡‘èæ•°æ®ï¼‰+ DeepSeekï¼ˆAIåˆ†æï¼‰
- **éƒ¨ç½²ï¼š** Vercel + Renderï¼ˆè‡ªåŠ¨åŒ–CI/CDï¼‰

é€šè¿‡è¿™ä¸ªé¡¹ç›®ï¼Œæ‚¨å¯ä»¥å­¦ä¹ åˆ°ï¼š

âœ… å®Œæ•´çš„å‰åç«¯åˆ†ç¦»æ¶æ„  
âœ… RESTful APIè®¾è®¡ä¸å®ç°  
âœ… æ•°æ®åº“è®¾è®¡ä¸CRUDæ“ä½œ  
âœ… å¤–éƒ¨APIé›†æˆä¸é”™è¯¯å¤„ç†  
âœ… äº‘å¹³å°éƒ¨ç½²ä¸ç¯å¢ƒé…ç½®  
âœ… å®é™…é—®é¢˜çš„è°ƒè¯•ä¸è§£å†³  

---

**æ–‡æ¡£ç‰ˆæœ¬ï¼š** v1.0  
**æœ€åæ›´æ–°ï¼š** 2025å¹´11æœˆ4æ—¥  
**è”ç³»æ–¹å¼ï¼š** å¦‚æœ‰ç–‘é—®ï¼Œè¯·æŸ¥çœ‹é¡¹ç›®READMEæˆ–æäº¤Issue

---

## é™„å½•ï¼šå¿«é€Ÿå‚è€ƒ

### å¸¸ç”¨å‘½ä»¤

```bash
# å‰ç«¯å¼€å‘
cd frontend
npm install
npm run dev

# åç«¯å¼€å‘
cd backend
pip install -r requirements.txt
python app.py

# éƒ¨ç½²
git add .
git commit -m "Update"
git push origin main  # è‡ªåŠ¨è§¦å‘Vercelå’ŒRenderéƒ¨ç½²
```

### ç¯å¢ƒå˜é‡å¿«é€Ÿé…ç½®

```bash
# å‰ç«¯ (.env.production)
REACT_APP_API_URL=https://decision-assistant-b.onrender.com

# åç«¯ (Render Dashboard)
DATABASE_URL=postgresql://...
ALPHA_VANTAGE_API_KEY=YOUR_KEY
DEEPSEEK_API_KEY=YOUR_KEY
PORT=10000
```

### å¸¸è§HTTPçŠ¶æ€ç 

| çŠ¶æ€ç  | å«ä¹‰ | åº”ç”¨åœºæ™¯ |
|-------|------|---------|
| 200 | æˆåŠŸ | è¯·æ±‚æˆåŠŸå¤„ç† |
| 400 | è¯·æ±‚é”™è¯¯ | å‚æ•°ç¼ºå¤±æˆ–æ ¼å¼é”™è¯¯ |
| 404 | æœªæ‰¾åˆ° | èµ„æºä¸å­˜åœ¨ |
| 500 | æœåŠ¡å™¨é”™è¯¯ | åç«¯ä»£ç å¼‚å¸¸ |
| 503 | æœåŠ¡ä¸å¯ç”¨ | æ•°æ®åº“è¿æ¥å¤±è´¥ |

---

**ğŸ‰ æ­å–œæ‚¨å®Œæˆäº†è¿™ä»½æŠ€æœ¯æ–‡æ¡£çš„å­¦ä¹ ï¼**


