# 🚀 快速部署 - 选择你的方案

> **5分钟选择最适合你的部署方案**

---

## 📋 快速决策树

```
你是谁？
│
├─ 🎓 学生/个人学习者
│  └─ 预算：免费
│     └─ ✅ 方案1: Vercel + Render (免费)
│        - 成本：$0
│        - 限制：后端15分钟无活动会休眠
│        - 适合：学习、测试、小型演示
│        👉 [查看详细步骤](#方案1-vercel--render-免费)
│
├─ 💼 创业者/小型项目
│  └─ 预算：$5-10/月
│     └─ ✅ 方案2: Vercel + Railway
│        - 成本：$5-10/月
│        - 特点：无休眠，稳定可靠
│        - 适合：小型商业项目
│        👉 [查看详细步骤](#方案2-vercel--railway-推荐)
│
├─ 🌍 需要全球高速访问
│  └─ 预算：$3-5/月
│     └─ ✅ 方案3: Cloudflare + Fly.io
│        - 成本：$3-5/月
│        - 特点：全球CDN，边缘计算
│        - 适合：国际化应用
│        👉 [查看详细步骤](#方案3-cloudflare--flyio)
│
├─ 🇨🇳 主要服务国内用户
│  └─ 预算：$10-20/月
│     └─ ✅ 方案4: 阿里云/腾讯云
│        - 成本：$10-20/月
│        - 特点：国内访问快
│        - 需要：备案
│        👉 [查看详细步骤](#方案4-国内云服务)
│
└─ 🔧 需要完全控制
   └─ 预算：$5-20/月
      └─ ✅ 方案5: Docker + VPS
         - 成本：$5-20/月（VPS）
         - 特点：完全控制
         - 需要：Linux知识
         👉 [查看详细步骤](#方案5-docker--vps)
```

---

## ⚡ 方案1: Vercel + Render (免费)

### 特点
- ✅ 完全免费
- ✅ 部署简单
- ⚠️ 后端会休眠（15分钟无活动）
- ⚠️ 首次访问需30-60秒唤醒

### 3步快速部署

#### 步骤1: 部署后端 (5分钟)
```
1. 访问 render.com，用GitHub登录
2. 点击 "New +" → "Web Service"
3. 选择你的仓库，配置:
   ✓ Root Directory: backend
   ✓ Build Command: pip install -r requirements.txt
   ✓ Start Command: uvicorn app.main:app --host 0.0.0.0 --port $PORT
4. 添加环境变量: DEEPSEEK_API_KEY=你的密钥
5. 点击 "Create Web Service"，等待3-5分钟
6. 复制后端URL (如: https://xxx.onrender.com)
```

#### 步骤2: 部署前端 (3分钟)
```bash
# 安装Vercel CLI
npm install -g vercel

# 进入前端目录并部署
cd frontend
vercel login
vercel --prod

# 或在 vercel.com 使用GitHub集成（更简单）
```

#### 步骤3: 连接前后端 (2分钟)
```
1. 在Vercel项目 → Settings → Environment Variables
2. 添加: REACT_APP_API_URL=你的后端URL
3. 点击 Deployments → Redeploy
```

### ✅ 测试
```bash
# 测试后端
curl https://你的后端URL/health

# 访问前端
# 打开浏览器访问你的Vercel URL
```

**总耗时：约10分钟**

---

## 🌟 方案2: Vercel + Railway (推荐)

### 特点
- ✅ 无休眠，始终在线
- ✅ 部署简单
- ✅ 性能稳定
- 💰 需付费 $5-10/月

### 快速部署

#### 步骤1: 部署后端到Railway (5分钟)
```
1. 访问 railway.app，用GitHub登录
2. 绑定信用卡（获得$5试用额度）
3. 点击 "New Project" → "Deploy from GitHub repo"
4. 选择你的仓库
5. Settings → Root Directory: backend
6. Variables → 添加:
   - DEEPSEEK_API_KEY=你的密钥
   - PORT=8000
7. Settings → Generate Domain
8. 复制生成的URL
```

#### 步骤2: 部署前端 (同方案1)
```bash
cd frontend
vercel --prod
```

#### 步骤3: 连接 (同方案1)

**总耗时：约10分钟**

**优势：** 比免费方案稳定，值得投资！

---

## 🌐 方案3: Cloudflare + Fly.io

### 特点
- ✅ 全球CDN，国内外都快
- ✅ 边缘计算
- ✅ 性价比高
- 🔧 配置稍复杂

### 快速部署

#### 步骤1: 部署前端到Cloudflare Pages
```bash
# 访问 Cloudflare Dashboard
# Pages → Create project → Connect GitHub
# 配置:
#   Build command: cd frontend && npm run build
#   Build output: frontend/build
```

#### 步骤2: 部署后端到Fly.io
```bash
# Windows (PowerShell)
iwr https://fly.io/install.ps1 -useb | iex

# Mac/Linux
curl -L https://fly.io/install.sh | sh

# 部署
cd backend
fly auth login
fly launch
fly secrets set DEEPSEEK_API_KEY=你的密钥
fly deploy
```

**总耗时：约15分钟**

---

## 🇨🇳 方案4: 国内云服务

### 推荐：阿里云或腾讯云

#### 前端：OSS + CDN
```bash
# 构建
cd frontend
npm run build

# 上传到OSS (使用阿里云/腾讯云控制台)
# 配置CDN加速
```

#### 后端：函数计算或云服务器
- **函数计算**：Serverless，按量付费
- **云服务器**：固定成本，更灵活

**注意：** 需要域名备案

**总耗时：约30-60分钟（含备案）**

---

## 🐳 方案5: Docker + VPS

### 适合有Linux经验的开发者

```bash
# 在VPS上执行
git clone https://github.com/你的仓库
cd decision-assistant
docker-compose up -d

# 配置Nginx反向代理
# 配置SSL证书 (Let's Encrypt)
```

**总耗时：约30分钟**

---

## 📊 方案对比速查表

| 特性 | 方案1 免费 | 方案2 Railway | 方案3 CF+Fly | 方案4 国内云 | 方案5 VPS |
|-----|-----------|--------------|-------------|------------|----------|
| **月成本** | $0 | $5-10 | $3-5 | $10-20 | $5-20 |
| **部署难度** | ⭐⭐ 简单 | ⭐⭐ 简单 | ⭐⭐⭐ 中等 | ⭐⭐⭐⭐ 较难 | ⭐⭐⭐⭐⭐ 复杂 |
| **稳定性** | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ |
| **国内速度** | ⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | 取决于VPS |
| **国际速度** | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐ | 取决于VPS |
| **休眠问题** | ❌ 会休眠 | ✅ 无休眠 | ✅ 无休眠 | ✅ 无休眠 | ✅ 无休眠 |
| **自动扩展** | ✅ | ✅ | ✅ | 部分支持 | ❌ |
| **数据持久化** | ⚠️ 受限 | ✅ | ✅ | ✅ | ✅ |

---

## 🎯 我的推荐

### 如果你是...

**学生/个人学习者**
→ **方案1** (免费)
- 完全免费
- 满足学习需求
- 10分钟即可完成

**创业者/小型项目**
→ **方案2** (Railway) ⭐ **最推荐**
- 只需$5-10/月
- 稳定可靠
- 节省时间成本

**需要全球用户访问**
→ **方案3** (Cloudflare + Fly.io)
- 全球CDN
- 性价比高
- 国内外都快

**主要服务国内用户**
→ **方案4** (阿里云/腾讯云)
- 国内访问最快
- 但需要备案

---

## ⚡ 一键开始

### Windows 用户
```bash
# 双击运行
deploy-setup.bat
```

### Mac/Linux 用户
```bash
chmod +x deploy-setup.sh
./deploy-setup.sh
```

### 或查看详细文档
```bash
# 完整部署指南 (推荐详细阅读)
start 部署方案完整指南.md

# 快速检查清单
start 部署快速检查.md
```

---

## 🆘 遇到问题？

### 常见问题快速解决

**Q: 部署后显示 CORS 错误？**
```
→ 检查后端 CORS 配置是否包含前端域名
→ 查看: 部署方案完整指南.md → 常见问题 → Q5
```

**Q: Render 后端很慢？**
```
→ 免费版会休眠，首次访问需30-60秒
→ 解决: 升级到付费版 或 切换到 Railway
```

**Q: API 返回 500 错误？**
```
→ 检查 DEEPSEEK_API_KEY 是否设置
→ 查看后端日志定位问题
```

### 获取帮助
- 📖 [部署方案完整指南](部署方案完整指南.md)
- ✅ [部署快速检查清单](部署快速检查.md)
- 📝 [技术总结](TECHNICAL_SUMMARY.md)

---

## ✅ 部署后检查

部署完成后，检查这些：

- [ ] ✅ 访问前端URL，页面正常显示
- [ ] ✅ 后端健康检查通过 (`/health` 返回 `{"status":"ok"}`)
- [ ] ✅ 浏览器控制台无CORS错误
- [ ] ✅ Decision Analysis 功能正常
- [ ] ✅ Chat Mode 可以对话
- [ ] ✅ Chat Viewer 可以查看记录

---

## 🎉 开始部署！

**准备好了吗？选择一个方案，10分钟即可完成！**

1. 💰 **预算有限？** → [方案1 免费方案](#方案1-vercel--render-免费)
2. 🎯 **追求稳定？** → [方案2 Railway](#方案2-vercel--railway-推荐) ⭐ **推荐**
3. 🌍 **全球用户？** → [方案3 Cloudflare](#方案3-cloudflare--flyio)

**或者运行一键配置脚本：**
```bash
# Windows
deploy-setup.bat

# Mac/Linux
./deploy-setup.sh
```

---

**祝部署顺利！** 🚀

有任何问题，请查看 [部署方案完整指南.md](部署方案完整指南.md) 获取详细帮助。

---

**文档版本:** 1.0  
**最后更新:** 2025-10-14  
**维护:** Decision Assistant Team

